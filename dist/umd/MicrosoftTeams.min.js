/*! For license information please see MicrosoftTeams.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("microsoftTeams",[],t):"object"==typeof exports?exports.microsoftTeams=t():e.microsoftTeams=t()}("undefined"!=typeof self?self:this,(()=>(()=>{var e={991:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=s(e),a=i[0],c=i[1],l=new o(u(e,a,c)),d=0,f=c>0?a-4:a;for(n=0;n<f;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[d++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=16383,s=0,u=r-o;s<u;s+=a)i.push(l(e,s,s+a>u?u:s+a));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){return 3*(t+n)/4-n}function c(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function l(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(c(r));return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},48:(e,t,n)=>{"use strict";var r=n(991),o=n(318);t.hp=s,t.IS=50;var i=2147483647;function a(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,n)}function u(e,t,n){if("string"==typeof e)return f(e,t);if(ArrayBuffer.isView(e))return p(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer))return h(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return s.from(r,t,n);var o=g(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e,t,n){return c(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}function d(e){return c(e),a(e<0?0:0|m(e))}function f(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|w(e,t),r=a(n),o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}function p(e){for(var t=e.length<0?0:0|m(e.length),n=a(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n)).__proto__=s.prototype,r}function g(e){if(s.isBuffer(e)){var t=0|m(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||Z(e.length)?a(0):p(e):"Buffer"===e.type&&Array.isArray(e.data)?p(e.data):void 0}function m(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function w(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(o)return r?-1:z(e).length;t=(""+t).toLowerCase(),o=!0}}function v(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return U(this,t,n);case"utf8":case"utf-8":return F(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return L(this,t,n);case"base64":return R(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function C(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Z(n=+n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){var i,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var l=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(n+u>s&&(n=s-u),i=n;i>=0;i--){for(var d=!0,f=0;f<u;f++)if(c(e,i+f)!==c(t,f)){d=!1;break}if(d)return i}return-1}function S(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(Z(s))return a;e[n+a]=s}return a}function E(e,t,n,r){return J(z(t,e.length-n),e,n,r)}function A(e,t,n,r){return J(q(t),e,n,r)}function I(e,t,n,r){return A(e,t,n,r)}function T(e,t,n,r){return J(G(t),e,n,r)}function P(e,t,n,r){return J($(t,e.length-n),e,n,r)}function R(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function F(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,u,c=e[o],l=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(i=e[o+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(u=(15&c)<<12|(63&i)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=d}return k(r)}s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,n){return u(e,t,n)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,n){return l(e,t,n)},s.allocUnsafe=function(e){return d(e)},s.allocUnsafeSlow=function(e){return d(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(K(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=s.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(K(i,Uint8Array)&&(i=s.from(i)),!s.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},s.byteLength=w,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?F(this,0,e):v.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",n=t.IS;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},s.prototype.compare=function(e,t,n,r,o){if(K(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(i,a),c=this.slice(r,o),l=e.slice(t,n),d=0;d<u;++d)if(c[d]!==l[d]){i=c[d],a=l[d];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return C(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return C(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return I(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function k(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=O));return n}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function L(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function U(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=j(e[i]);return o}function N(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,o,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function H(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function _(e,t,n,r,i){return t=+t,n>>>=0,i||H(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,i){return t=+t,n>>>=0,i||H(e,0,n,8),o.write(e,t,n,r,52,8),n+8}s.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=s.prototype,r},s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},s.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),o.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),o.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),o.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),o.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);D(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);D(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,n){return _(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return _(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var i=o-1;i>=0;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return o},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var o=e.charCodeAt(0);("utf8"===r&&o<128||"latin1"===r)&&(e=o)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=s.isBuffer(e)?e:s.from(e,r),u=a.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=a[i%u]}return this};var V=/[^+/0-9A-Za-z-_]/g;function W(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function q(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function $(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}function G(e){return r.toByteArray(W(e))}function J(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}},124:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(891)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},891:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(250),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},318:(e,t)=>{t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?o-1:0,f=n?-1:1,p=e[t+d];for(d+=f,i=p&(1<<-l)-1,p>>=-l,l+=s;l>0;i=256*i+e[t+d],d+=f,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=f,l-=8);if(0===i)i=1-c;else{if(i===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),i-=c}return(p?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,u,c=8*i-o-1,l=(1<<c)-1,d=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,h=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(a++,u/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*u-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[n+p]=255&s,p+=h,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+p]=255&a,p+=h,a/=256,c-=8);e[n+p-h]|=128*g}},250:e=>{var t=1e3,n=60*t,r=60*n,o=24*r,i=7*o;function a(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function s(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}function u(e){var i=Math.abs(e);return i>=o?c(e,i,o,"day"):i>=r?c(e,i,r,"hour"):i>=n?c(e,i,n,"minute"):i>=t?c(e,i,t,"second"):e+" ms"}function c(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return a(e);if("number"===n&&isFinite(e))return t.long?u(e):s(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"==typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,n.d(i,a),i}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})();var r={};return(()=>{"use strict";n.r(r),n.d(r,{ActionObjectType:()=>t,AppId:()=>lt,ChannelType:()=>b,ChildAppWindow:()=>pi,DialogDimension:()=>w,EmailAddress:()=>No,ErrorCode:()=>i,FileOpenPreference:()=>e,FrameContexts:()=>h,HostClientType:()=>f,HostName:()=>p,LiveShareHost:()=>Ea,NotificationTypes:()=>Rr,ParentAppWindow:()=>hi,SecondaryM365ContentIdName:()=>o,TaskModuleDimension:()=>S,TeamType:()=>g,UserSettingTypes:()=>Or,UserTeamRole:()=>m,ViewerActionTypes:()=>Fr,app:()=>xt,appEntity:()=>io,appInitialization:()=>Vi,appInstallDialog:()=>Vo,authentication:()=>gt,barCode:()=>oi,calendar:()=>bi,call:()=>_i,chat:()=>ii,clipboard:()=>si,conversations:()=>_r,copilot:()=>Br,dialog:()=>bt,enablePrintCapability:()=>$i,executeDeepLink:()=>ua,externalAppAuthentication:()=>Wr,externalAppAuthenticationForCEA:()=>qr,externalAppCardActions:()=>$r,externalAppCardActionsForCEA:()=>Jr,externalAppCommands:()=>Zr,files:()=>Xr,geoLocation:()=>li,getAdaptiveCardSchemaVersion:()=>di,getContext:()=>Ji,getMruTabInstances:()=>aa,getTabInstances:()=>ia,hostEntity:()=>Lo,initialize:()=>qi,initializeWithFrameContext:()=>la,liveShare:()=>Sa,location:()=>mi,logs:()=>Pr,mail:()=>Si,marketplace:()=>Ha,media:()=>zo,meeting:()=>yi,meetingRoom:()=>eo,menus:()=>Et,messageChannels:()=>dt,monetization:()=>Ci,navigateBack:()=>ga,navigateCrossDomain:()=>ha,navigateToTab:()=>pa,nestedAppAuth:()=>ui,notifications:()=>to,openFilePreview:()=>Dr,otherAppStateChange:()=>no,pages:()=>Zt,people:()=>Ai,print:()=>Gi,profile:()=>Pi,registerAppButtonClickHandler:()=>Qi,registerAppButtonHoverEnterHandler:()=>Xi,registerAppButtonHoverLeaveHandler:()=>Yi,registerBackButtonHandler:()=>ea,registerBeforeUnloadHandler:()=>na,registerChangeSettingsHandler:()=>oa,registerCustomHandler:()=>Nr,registerFocusEnterHandler:()=>ra,registerFullScreenHandler:()=>Zi,registerOnLoadHandler:()=>ta,registerOnThemeChangeHandler:()=>Ki,registerUserSettingsChangeHandler:()=>xr,remoteCamera:()=>oo,returnFocus:()=>fa,search:()=>Fi,secondaryBrowser:()=>gi,sendCustomEvent:()=>Ur,sendCustomMessage:()=>Lr,setFrameContext:()=>ca,settings:()=>wa,shareDeepLink:()=>sa,sharing:()=>ki,stageView:()=>Mi,tasks:()=>Ca,teams:()=>so,teamsCore:()=>Ei,thirdPartyCloudStorage:()=>ji,uploadCustomApp:()=>Mr,version:()=>_e,videoEffects:()=>mo,videoEffectsEx:()=>ko,visualMedia:()=>Ni,webStorage:()=>xi});var e,t,o,i,a,s,u,c,l,d,f,p,h,g,m,w,v=n(124),y=n(48);function C(e){return void 0!==(null==e?void 0:e.errorCode)}!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(e||(e={})),function(e){e.M365Content="m365content"}(t||(t={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(o||(o={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(i||(i={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(a||(a={})),function(e){e.BCAIS="bcais",e.BCWAF="bcwaf",e.BCWBF="bcwbf"}(s||(s={})),function(e){e.Faculty="faculty",e.Student="student",e.Other="other"}(u||(u={})),function(e){e.Adult="adult",e.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",e.MinorWithoutParentalConsent="minorWithoutParentalConsent",e.MinorWithParentalConsent="minorWithParentalConsent",e.NonAdult="nonAdult"}(c||(c={})),function(e){e.HigherEducation="higherEducation",e.K12="k12",e.Other="other"}(l||(l={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(d||(d={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(f||(f={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(p||(p={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(h||(h={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(g||(g={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(m||(m={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(w||(w={}));var b,S=w;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(b||(b={}));const E={errorCode:i.NOT_SUPPORTED_ON_PLATFORM},A=1,I=5,T={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},P=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),R=new Error("Invalid response: Received more images than the specified max limit in the response.");function F(){const e="0123456789abcdef";let t="";for(let n=0;n<36;n++)t+=8===n||13===n||18===n||23===n?"-":14===n?"4":19===n?e.substr(4*Math.random()|8,1):e[Math.floor(16*Math.random())];return t}function O(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function k(e){return(t,n)=>{if(!t)throw new Error(e||n)}}function M(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;const n=e.split("."),r=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!r.every(o))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(let e=0;e<n.length;++e)if(Number(n[e])!=Number(r[e]))return Number(n[e])>Number(r[e])?1:-1;return 0}function L(){return F()}function U(e){return Object.keys(e).forEach((t=>{null!==e[t]&&void 0!==e[t]&&"object"==typeof e[t]&&U(e[t])})),Object.freeze(e)}function N(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(void 0,e)})).catch((e=>{t&&t(e)})),r}function x(e,t,...n){const r=e(...n);return r.then((()=>{t&&t(null)})).catch((e=>{t&&t(e)})),r}function D(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(null,e)})).catch((e=>{t&&t(e,null)})),r}function H(e,t,n){return new Promise(((r,o)=>{const i=setTimeout(o,t,n);e().then((e=>{clearTimeout(i),r(e)})).catch((e=>{clearTimeout(i),o(e)}))}))}function _(e){const t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId.toString())+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl.toString()),(e.chatId||e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({chatId:e.chatId,channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function B(e){return!(M(`${e.majorVersion}.${e.minorVersion}`,`${A}.${I}`)>=0)}function V(e){return"https:"===e.protocol}function W(e,t){return new Promise(((n,r)=>{if(e||r("MimeType cannot be null or empty."),t||r("Base64 string cannot be null or empty."),e.startsWith("image/")){const r=atob(t),o=new Uint8Array(r.length);for(let e=0;e<r.length;e++)o[e]=r.charCodeAt(e);n(new Blob([o],{type:e}))}const o=y.hp.from(t,"base64").toString();n(new Blob([o],{type:e}))}))}function j(e){return new Promise(((t,n)=>{0===e.size&&n(new Error("Blob cannot be empty."));const r=new FileReader;r.onloadend=()=>{r.result?t(r.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},r.onerror=()=>{n(r.error)},r.readAsDataURL(e)}))}function z(){if(q())throw new Error("window object undefined at SSR check");return window}function q(){return"undefined"==typeof window}function $(e,t){if(K(e)||!Z(e)||!Q(e))throw t||new Error("id is not valid.")}function G(e,t){const n=e.toString().toLocaleLowerCase();if(K(n))throw t||new Error("Invalid Url");if(n.length>2048)throw t||new Error("Url exceeds the maximum size of 2048 characters");if(!V(e))throw t||new Error("Url should be a valid https url")}function J(e){const t=document.createElement("a");return t.href=e,new URL(t.href)}function K(e){return new RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`,"gi").test(e)}function Z(e){return e.length<256&&e.length>4}function Q(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}function X(e){if(!e)throw new Error("id must not be empty");if(!1===O(e))throw new Error("id must be a valid UUID")}class Y{constructor(e=L()){this.uuid=e,X(e)}toString(){return this.uuid}}const ee=new Y,te=v.debug.formatArgs;v.debug.formatArgs=function(e){e[0]=`(${(new Date).toISOString()}): ${e[0]} [${ee.toString()}]`,te.call(this,e)};const ne=(0,v.debug)("teamsJs");function re(e){return ne.extend(e)}function oe(e,t){return`${e}_${t}`}function ie(e){return/^v\d+_[\w.]+$/.test(e)}const ae=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","work.bing.com","www.bing.com","www.staging-bing-int.com","*.cloud.microsoft","*.m365.cloud.microsoft","edgeapi.freya.svc.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net","fa000000136.resources.office.net"]}');const se="2.0.1",ue="2.0.3",ce="1.9.0",le="1.8.0",de=n.t(ae,2).validOrigins,fe=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),pe=/^https:\/\//,he="https",ge="teams.microsoft.com",me="The library has not yet been initialized",we="The runtime has not yet been initialized",ve="The runtime version is not supported";class ye{}ye.initializeCalled=!1,ye.initializeCompleted=!1,ye.additionalValidOrigins=[],ye.initializePromise=void 0,ye.isFramelessWindow=!1,ye.frameContext=void 0,ye.hostClientType=void 0,ye.printCapabilityEnabled=!1;var Ce=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const be=re("runtime"),Se=4;function Ee(e){return e.apiVersion===Se}const Ae={apiVersion:-1,supports:{}};function Ie(e){if(Ee(e))return!0;throw-1===e.apiVersion?new Error(we):new Error(ve)}let Te=Ae;const Pe={apiVersion:4,isNAAChannelRecommended:!1,hostVersionsInfo:T,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},Re=[f.desktop,f.web,f.rigel,f.surfaceHub,f.teamsRoomsWindows,f.teamsRoomsAndroid,f.teamsPhones,f.teamsDisplays],Fe=[f.android,f.ios,f.ipados],Oe=[...Re,...Fe];function ke(e){let t=e;if(t.apiVersion<Se&&Me.forEach((e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))})),Ee(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}const Me=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{const t=e.supports,{appNotification:n}=t,r=Ce(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,n,r,o,i;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null===(t=e.supports.dialog)||void 0===t?void 0:t.card,url:{bot:null===(r=null===(n=e.supports.dialog)||void 0===n?void 0:n.url)||void 0===r?void 0:r.bot,parentCommunication:(null===(o=e.supports.dialog)||void 0===o?void 0:o.url)?{}:void 0},update:null===(i=e.supports.dialog)||void 0===i?void 0:i.update}:void 0})}}}],Le={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:Re}],"1.9.0":[{capability:{location:{}},hostClientTypes:Oe}],"2.0.0":[{capability:{people:{}},hostClientTypes:Oe},{capability:{sharing:{}},hostClientTypes:[f.desktop,f.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[f.android,f.desktop,f.ios,f.teamsRoomsAndroid,f.teamsPhones,f.teamsDisplays,f.web]},{capability:{webStorage:{}},hostClientTypes:[f.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[f.android,f.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[f.android,f.ios]}]},Ue=be.extend("generateBackCompatRuntimeConfig");function Ne(e,t){const n=Object.assign({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&("object"!=typeof t[r]||Array.isArray(t[r])?r in e||(n[r]=t[r]):n[r]=Ne(e[r]||{},t[r]));return n}function xe(e,t,n){Ue("generating back compat runtime config for %s",e);let r=Object.assign({},t.supports);Ue("Supported capabilities in config before updating based on highestSupportedVersion: %o",r),Object.keys(n).forEach((t=>{M(e,t)>=0&&n[t].forEach((e=>{void 0!==ye.hostClientType&&e.hostClientTypes.includes(ye.hostClientType)&&(r=Ne(r,e.capability))}))}));const o={apiVersion:Se,hostVersionsInfo:T,isLegacyTeams:!0,supports:r};return Ue("Runtime config after updating based on highestSupportedVersion: %o",o),o}const De=be.extend("applyRuntimeConfig");function He(e){"string"==typeof e.apiVersion&&(De("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),De("Fast-forwarding runtime %o",e);const t=ke(e);De("Applying runtime %o",t),Te=U(t)}const _e="2.29.0",Be=re("internal"),Ve=Be.extend("ensureInitializeCalled"),We=Be.extend("ensureInitialized");function je(){if(!ye.initializeCalled)throw Ve(me),new Error(me)}function ze(e,...t){if(!ye.initializeCompleted)throw We("%s. initializeCalled: %s",me,ye.initializeCalled.toString()),new Error(me);if(t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===ye.frameContext){e=!0;break}if(!e)throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${ye.frameContext}".`)}return Ie(e)}function qe(e=se){const t=M(ye.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function $e(){return ye.hostClientType==f.android||ye.hostClientType==f.ios||ye.hostClientType==f.ipados}function Ge(e=se){if(!$e()){throw{errorCode:i.NOT_SUPPORTED_ON_PLATFORM}}if(!qe(e)){throw{errorCode:i.OLD_PLATFORM}}}function Je(e){let t=ye.additionalValidOrigins.concat(e.filter((e=>"string"==typeof e&&pe.test(e))));const n={};t=t.filter((e=>!n[e]&&(n[e]=!0,!0))),ye.additionalValidOrigins=t}function Ke(e){return null==e}var Ze=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};let Qe=[];const Xe=re("validateOrigin");function Ye(){return Ze(this,void 0,void 0,(function*(){yield tt()}))}function et(){return 0===Qe.length}function tt(){return Ze(this,void 0,void 0,(function*(){return et()?q()?(Qe=de,de):fetch(fe).then((e=>{if(!e.ok)throw new Error("Invalid Response from Fetch Call");return e.json().then((e=>{if(nt(JSON.stringify(e)))return Qe=e.validOrigins,Qe;throw new Error("Valid Origins List Is Invalid")}))})).catch((e=>(Xe("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),Qe=de,Qe))):Qe}))}function nt(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(const e of t.validOrigins)try{new URL("https://"+e)}catch(t){return Xe("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}function rt(e,t){if("*."===e.substring(0,2)){const n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}function ot(e){return tt().then((t=>{if(!V(e))return Xe("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;const n=e.host;if(t.some((e=>rt(e,n))))return!0;for(const e of ye.additionalValidOrigins){if(rt("https://"===e.substring(0,8)?e.substring(8):e,n))return!0}return Xe("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,ye.additionalValidOrigins),!1}))}function it(e){if(K(e))throw new Error(`Potential app id (${e}) is invalid; it contains script tags.`);if(!ut(e))throw new Error(`Potential app id (${e}) is invalid; its length ${e.length} is not within the length limits (${at}-${st}).`);if(ct(e))throw new Error(`Potential app id (${e}) is invalid; it contains non-printable characters.`)}const at=4,st=256;function ut(e){return e.length<st&&e.length>at}function ct(e){return[...e].some((e=>{const t=e.charCodeAt(0);return t<32||t>126}))}class lt{constructor(e){this.appIdAsString=e,it(e)}toString(){return this.appIdAsString}}var dt,ft=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};!function(e){let t,n;!function(e){let t;const n=re("messageChannels.telemetry");function r(){var e;return!(!ze(Te)||!(null===(e=Te.supports.messageChannels)||void 0===e?void 0:e.telemetry))}e.getTelemetryPort=function(){return ft(this,void 0,void 0,(function*(){if(t)return n("Returning telemetry port from cache"),t;if(!r())throw E;return t=yield Wn(oe("v1","messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort"),t}))},e.isSupported=r,e._clearTelemetryPort=function(){t=void 0}}(t=e.telemetry||(e.telemetry={})),function(e){let t;const n=re("messageChannels.dataLayer");function r(){var e;return!(!ze(Te)||!(null===(e=Te.supports.messageChannels)||void 0===e?void 0:e.dataLayer))}e.getDataLayerPort=function(){return ft(this,void 0,void 0,(function*(){if(t)return n("Returning dataLayer port from cache"),t;if(!r())throw E;return t=yield Wn(oe("v1","messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort"),t}))},e.isSupported=r,e._clearDataLayerPort=function(){t=void 0}}(n=e.dataLayer||(e.dataLayer={})),e.isSupported=function(){return!(!ze(Te)||!Te.supports.messageChannels)}}(dt||(dt={}));const pt="v1",ht="v2";var gt;!function(e){let t,n,r,o;function i(e,n){return new Promise(((r,o)=>{if(ye.hostClientType!==f.web){const t=J(n.url);G(t),r(Vn(e,"authentication.authenticate",[t.href,n.width,n.height,n.isExternal]).then((([e,t])=>{if(e)return t;throw new Error(t)})))}else t={success:r,fail:o},c(n)}))}function a(e,t){return new Promise((n=>{n(Vn(e,"authentication.getAuthToken",[null==t?void 0:t.resources,null==t?void 0:t.claims,null==t?void 0:t.silent,null==t?void 0:t.tenantId]))})).then((([e,t])=>{if(e)return t;throw new Error(t)}))}function s(e){return new Promise((t=>{t(Vn(e,"authentication.getUser"))})).then((([e,t])=>{if(e)return t;throw t}))}function u(){l();try{Ln.childWindow&&Ln.childWindow.close()}finally{Ln.childWindow=null,Ln.childOrigin=null}}function c(e){u();let t=e.width||600,n=e.height||400;t=Math.min(t,Ln.currentWindow.outerWidth-400),n=Math.min(n,Ln.currentWindow.outerHeight-200);const r=J(e.url.replace("{oauthRedirectMethod}","web"));G(r);let o=void 0!==Ln.currentWindow.screenLeft?Ln.currentWindow.screenLeft:Ln.currentWindow.screenX,i=void 0!==Ln.currentWindow.screenTop?Ln.currentWindow.screenTop:Ln.currentWindow.screenY;o+=Ln.currentWindow.outerWidth/2-t/2,i+=Ln.currentWindow.outerHeight/2-n/2,Ln.childWindow=Ln.currentWindow.open(r.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+i+", left="+o+", width="+t+", height="+n),Ln.childWindow?d():g("FailedToOpenWindow")}function l(){n&&(clearInterval(n),n=0),cn("initialize"),cn("navigateCrossDomain")}function d(){l(),n=Ln.currentWindow.setInterval((()=>{if(!Ln.childWindow||Ln.childWindow.closed)g("CancelledByUser");else{const e=Ln.childOrigin;try{Ln.childOrigin="*",br("ping")}finally{Ln.childOrigin=e}}}),100),un(oe(pt,"authentication.authenticationWindow.registerInitializeHandler"),"initialize",(()=>[h.authentication,ye.hostClientType])),un(oe(pt,"authentication.authenticationWindow.registerNavigateCrossDomainHandler"),"navigateCrossDomain",(()=>!1))}function p(e){try{t&&t.success(e)}finally{t=void 0,u()}}function g(e){try{t&&t.fail(new Error(e))}finally{t=void 0,u()}}e.initialize=function(){un(oe(pt,"authentication.registerAuthenticateSuccessHandler"),"authentication.authenticate.success",p,!1),un(oe(pt,"authentication.registerAuthenticateFailureHandler"),"authentication.authenticate.failure",g,!1)},e.registerAuthenticationHandlers=function(e){r=e},e.authenticate=function(e){const t=void 0!==e,n=t?e:r;if(!n)throw new Error("No parameters are provided for authentication");return ze(Te,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage),i(n.successCallback||n.failureCallback?oe(pt,"authentication.authenticate"):oe(ht,"authentication.authenticate"),n).then((e=>{try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(r=void 0)}})).catch((e=>{try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(r=void 0)}}))},e.getAuthToken=function(e){return je(),a(e&&(e.successCallback||e.failureCallback)?oe(pt,"authentication.getAuthToken"):oe(ht,"authentication.getAuthToken"),e).then((t=>e&&e.successCallback?(e.successCallback(t),""):t)).catch((t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t}))},e.getUser=function(e){return je(),s(e&&(e.successCallback||e.failureCallback)?oe(pt,"authentication.getUser"):oe(ht,"authentication.getUser")).then((t=>e&&e.successCallback?(e.successCallback(t),null):t)).catch((t=>{const n=`Error returned, code = ${t.errorCode}, message = ${t.message}`;if(e&&e.failureCallback)return e.failureCallback(n),null;throw new Error(n)}))},e.notifySuccess=function(e,t){ze(Te,h.authentication),qn(oe(t?pt:ht,"authentication.notifySuccess"),"authentication.authenticate.success",[e]),yr(Ln.parentWindow,(()=>setTimeout((()=>Ln.currentWindow.close()),200)))},e.notifyFailure=function(e,t){ze(Te,h.authentication),qn(oe(t?pt:ht,"authentication.notifyFailure"),"authentication.authenticate.failure",[e]),yr(Ln.parentWindow,(()=>setTimeout((()=>Ln.currentWindow.close()),200)))},function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(o=e.DataResidency||(e.DataResidency={}))}(gt||(gt={}));const mt="v2";function wt(e,t){if(ze(Te,h.content,h.sidePanel,h.task,h.meetingStage),!bt.update.isSupported())throw E;qn(e,"tasks.updateTask",[t])}function vt(e,t,n,r){if(ze(Te,h.content,h.sidePanel,h.meetingStage),!bt.url.isSupported())throw E;r&&un(oe(mt,"dialog.url.registerMessageForParentHandler"),"messageForParent",r);qn(e,"tasks.startTask",[bt.url.getDialogInfoFromUrlDialogInfo(t)],((e,t)=>{null==n||n({err:e,result:t}),cn("messageForParent")}))}function yt(e,t,n,r){if(ze(Te,h.content,h.sidePanel,h.meetingStage),!bt.url.bot.isSupported())throw E;r&&un(oe(mt,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",r);qn(e,"tasks.startTask",[bt.url.getDialogInfoFromBotUrlDialogInfo(t)],((e,t)=>{null==n||n({err:e,result:t}),cn("messageForParent")}))}function Ct(e,t,n){if(ze(Te,h.task),!bt.url.isSupported())throw E;qn(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}var bt;!function(e){const t=[];function n(e){ye.frameContext&&(ye.frameContext===h.task?t.push(e):cn("messageForChild"))}let r,o,i;e.initialize=function(){un(oe(mt,"dialog.registerMessageForChildHandler"),"messageForChild",n,!1)},function(e){let n,r;function o(e){return{url:e.url,height:e.size?e.size.height:w.Small,width:e.size?e.size.width:w.Small,title:e.title,fallbackUrl:e.fallbackUrl}}e.open=function(e,t,n){vt(oe(mt,"dialog.url.open"),e,t,n)},e.submit=function(e,t){Ct(oe(mt,"dialog.url.submit"),e,t)},function(e){function n(){var e,t;return ze(Te)&&!!(null===(t=null===(e=Te.supports.dialog)||void 0===e?void 0:e.url)||void 0===t?void 0:t.parentCommunication)}e.sendMessageToParentFromDialog=function(e){if(ze(Te,h.task),!n())throw E;qn(oe(mt,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])},e.sendMessageToDialog=function(e){if(ze(Te,h.content,h.sidePanel,h.meetingStage),!n())throw E;qn(oe(mt,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])},e.registerOnMessageFromParent=function(e){if(ze(Te,h.task),!n())throw E;for(cn("messageForChild"),un(oe(mt,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),t.reverse();t.length>0;){e(t.pop())}},e.isSupported=n}(n=e.parentCommunication||(e.parentCommunication={})),e.isSupported=function(){return ze(Te)&&void 0!==(Te.supports.dialog&&Te.supports.dialog.url)},function(e){e.open=function(e,t,n){yt(oe(mt,"dialog.url.bot.open"),e,t,n)},e.isSupported=function(){return ze(Te)&&void 0!==(Te.supports.dialog&&Te.supports.dialog.url&&Te.supports.dialog.url.bot)}}(r=e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=o,e.getDialogInfoFromBotUrlDialogInfo=function(e){const t=o(e);return t.completionBotId=e.completionBotId,t}}(r=e.url||(e.url={})),e.isSupported=function(){return!(!ze(Te)||!Te.supports.dialog)},function(e){e.resize=function(e){wt(oe(mt,"dialog.update.resize"),e)},e.isSupported=function(){return!(!ze(Te)||!Te.supports.dialog)&&!!Te.supports.dialog.update}}(o=e.update||(e.update={})),function(e){function t(){const e=Te.hostVersionsInfo&&Te.hostVersionsInfo.adaptiveCardSchemaVersion&&!B(Te.hostVersionsInfo.adaptiveCardSchemaVersion);return ze(Te)&&void 0!==(e&&Te.supports.dialog&&Te.supports.dialog.card)}let n;function r(e){return{card:e.card,height:e.size?e.size.height:w.Small,width:e.size?e.size.width:w.Small,title:e.title}}function o(e){const t=r(e);return t.completionBotId=e.completionBotId,t}e.open=function(e,n){if(ze(Te,h.content,h.sidePanel,h.meetingStage),!t())throw E;const o=r(e);qn(oe(mt,"dialog.adaptiveCard.open"),"tasks.startTask",[o],((e,t)=>{null==n||n({err:e,result:t})}))},e.isSupported=t,function(e){function t(){const e=Te.hostVersionsInfo&&Te.hostVersionsInfo.adaptiveCardSchemaVersion&&!B(Te.hostVersionsInfo.adaptiveCardSchemaVersion);return ze(Te)&&void 0!==(e&&Te.supports.dialog&&Te.supports.dialog.card&&Te.supports.dialog.card.bot)}e.open=function(e,n){if(ze(Te,h.content,h.sidePanel,h.meetingStage),!t())throw E;const r=o(e);qn(oe(mt,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[r],((e,t)=>{null==n||n({err:e,result:t})}))},e.isSupported=t}(n=e.bot||(e.bot={}))}(i=e.adaptiveCard||(e.adaptiveCard={}))}(bt||(bt={}));const St="v2";var Et;!function(e){let t,n,r,o,i;!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(t=e.DisplayMode||(e.DisplayMode={}));function a(e){i&&i(e)||(ze(Te),qn(oe(St,"menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function s(e){r&&r(e)||(ze(Te),qn(oe(St,"menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function u(e){o&&o(e)||(ze(Te),qn(oe(St,"menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function c(){return!(!ze(Te)||!Te.supports.menus)}e.MenuItem=class{constructor(){this.enabled=!0,this.selected=!1}},function(e){e.dropDown="dropDown",e.popOver="popOver"}(n=e.MenuListType||(e.MenuListType={})),e.initialize=function(){un(oe(St,"menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",s,!1),un(oe(St,"menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",u,!1),un(oe(St,"menus.registerSetModuleViewHandler"),"setModuleView",a,!1)},e.setUpViews=function(e,t){if(ze(Te),!c())throw E;i=t,qn(oe(St,"menus.setUpViews"),"setUpViews",[e])},e.setNavBarMenu=function(e,t){if(ze(Te),!c())throw E;r=t,qn(oe(St,"menus.setNavBarMenu"),"setNavBarMenu",[e])},e.showActionMenu=function(e,t){if(ze(Te),!c())throw E;o=t,qn(oe(St,"menus.showActionMenu"),"showActionMenu",[e])},e.isSupported=c}(Et||(Et={}));const At="v2",It=5e3,Tt=re("app");function Pt(e,t){if(q()){return Tt.extend("initialize")("window object undefined at initialization"),Promise.resolve()}return H((()=>Lt(e,t)),It,new Error("SDK initialization timed out."))}function Rt(e){qn(e,xt.Messages.AppLoaded,[_e])}function Ft(e,t){qn(e,xt.Messages.ExpectedFailure,[t.reason,t.message])}function Ot(e,t){qn(e,xt.Messages.Failure,[t.reason,t.message])}function kt(e){qn(e,xt.Messages.Success,[_e])}const Mt=Tt.extend("initializeHelper");function Lt(e,t){return new Promise((n=>{ye.initializeCalled||(ye.initializeCalled=!0,rn(),ye.initializePromise=Nn(t,e).then((({context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r=se})=>{ye.frameContext=e,ye.hostClientType=t,ye.clientSupportedSDKVersion=r;try{Mt("Parsing %s",n);const e=JSON.parse(n);if(Mt("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw new Error("Received runtime config is invalid");n&&He(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{Mt("Attempting to parse %s as an SDK version",n),isNaN(M(n,se))||(ye.clientSupportedSDKVersion=n);const e=JSON.parse(r);if(Mt("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");He(e)}catch(e){if(!(e instanceof SyntaxError))throw e;He(xe(ye.clientSupportedSDKVersion,Pe,Le))}}ye.initializeCompleted=!0})),gt.initialize(),Et.initialize(),Zt.config.initialize(),bt.initialize()),Array.isArray(t)&&Je(t),void 0!==ye.initializePromise?n(ye.initializePromise):Mt("GlobalVars.initializePromise is unexpectedly undefined")}))}function Ut(e,t){!Ke(t)&&je(),fn(e,t)}function Nt(e,t){return new Promise((n=>{ze(Te,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),n(Hn(e,"executeDeepLink",t))}))}var xt;function Dt(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:p.teams,clientType:e.hostClientType?e.hostClientType:f.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:ye.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,isBackgroundLoad:e.isBackgroundLoad,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0,dialogParameters:e.dialogParameters||{}}}!function(e){const t=re("app");let n,r,o;e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(n=e.FailedReason||(e.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(r=e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.isInitialized=function(){return ye.initializeCompleted},e.getFrameContext=function(){return ye.frameContext},t("teamsjs instance is version %s, starting at %s UTC (%s local)",_e,(new Date).toISOString(),(new Date).toLocaleString()),function(){if(q())return;const e=document.getElementsByTagName("script"),n=e&&e[e.length-1]&&e[e.length-1].src,r="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";n&&0!==n.length?t("teamsjs is being used from %s. %s",n,r):t("teamsjs is being used from a script tag embedded directly in your html. %s",r)}(),e.initialize=function(e){return Ye(),Pt(oe(At,"app.initialize"),e)},e._initialize=function(e){Ln.currentWindow=e},e._uninitialize=function(){ye.initializeCalled&&(on(),ye.initializeCalled=!1,ye.initializeCompleted=!1,ye.initializePromise=void 0,ye.additionalValidOrigins=[],ye.frameContext=void 0,ye.hostClientType=void 0,ye.isFramelessWindow=!1,dt.telemetry._clearTelemetryPort(),dt.dataLayer._clearDataLayerPort(),xn())},e.getContext=function(){return new Promise((e=>{je(),e(Dn(oe(At,"app.getContext"),"getContext"))})).then((e=>Dt(e)))},e.notifyAppLoaded=function(){je(),Rt(oe(At,"app.notifyAppLoaded"))},e.notifySuccess=function(){je(),kt(oe(At,"app.notifySuccess"))},e.notifyFailure=function(e){je(),Ot(oe(At,"app.notifyFailure"),e)},e.notifyExpectedFailure=function(e){je(),Ft(oe(At,"app.notifyExpectedFailure"),e)},e.registerOnThemeChangeHandler=function(e){Ut(oe(At,"app.registerOnThemeChangeHandler"),e)},e.openLink=function(e){return Nt(oe(At,"app.openLink"),e)},function(e){e.registerBeforeSuspendOrTerminateHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");ze(Te),yn(e)},e.registerOnResumeHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");ze(Te),Cn(e)}}(o=e.lifecycle||(e.lifecycle={}))}(xt||(xt={}));const Ht="v2";function _t(e,t){return new Promise((n=>{if(ze(Te,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage),!Zt.isSupported())throw E;n(_n(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))}))}function Bt(e){return new Promise((t=>{if(ze(Te),!Zt.backStack.isSupported())throw E;t(_n(e,"navigateBack","Back navigation is not supported in the current client or context."))}))}function Vt(e,t){return new Promise((n=>{if(ze(Te),!Zt.tabs.isSupported())throw E;n(_n(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))}))}function Wt(e,t){if(ze(Te),!Zt.isSupported())throw E;qn(e,"returnFocus",[t])}function jt(e,t){return new Promise((n=>{if(ze(Te),!Zt.tabs.isSupported())throw E;n(Dn(e,"getTabInstances",t))}))}function zt(e,t){return new Promise((n=>{if(ze(Te),!Zt.tabs.isSupported())throw E;n(Dn(e,"getMruTabInstances",t))}))}function qt(e,t){if(ze(Te,h.content,h.sidePanel,h.meetingStage),!Zt.isSupported())throw E;qn(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function $t(e,t){if(ze(Te,h.content),!Zt.isSupported())throw E;qn(e,"setFrameContext",[t])}function Gt(e,t){if(ze(Te,h.settings,h.remove),!Zt.config.isSupported())throw E;qn(e,"settings.setValidityState",[t])}function Jt(e){return new Promise((t=>{if(ze(Te,h.content,h.settings,h.remove,h.sidePanel),!Zt.isSupported())throw E;t(Dn(e,"settings.getSettings"))}))}function Kt(e,t){return new Promise((n=>{if(ze(Te,h.content,h.settings,h.sidePanel),!Zt.config.isSupported())throw E;n(Hn(e,"settings.setSettings",t))}))}var Zt;function Qt(e){return e.appId instanceof lt}function Xt(e){return Object.assign(Object.assign({},e),{appId:new lt(e.appId),webUrl:e.webUrl?new URL(e.webUrl):void 0})}function Yt(e){return Object.assign(Object.assign({},e),{appId:e.appId.toString(),webUrl:e.webUrl?e.webUrl.toString():void 0})}!function(e){let t,n,r,o,i,a,s,u;function c(e){$t(oe(Ht,"pages.setCurrentFrame"),e)}function l(){return!(!ze(Te)||!Te.supports.pages)}!function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.Read=2]="Read",e[e.Compose=3]="Compose"}(t=e.EnterFocusType||(e.EnterFocusType={})),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.GoToActivityFeed=2]="GoToActivityFeed"}(n=e.ReturnFocusType||(e.ReturnFocusType={})),e.returnFocus=function(t){const n=oe(Ht,"pages.returnFocus");if(ze(Te),!e.isSupported())throw E;if(void 0===t&&qn(n,"returnFocus",[!1]),"boolean"==typeof t)qn(n,"returnFocus",[t]);else switch(t){case e.ReturnFocusType.PreviousLandmark:case e.ReturnFocusType.GoToActivityFeed:qn(n,"returnFocus",[!1,t]);break;case e.ReturnFocusType.NextLandmark:qn(n,"returnFocus",[!0,t])}},e.registerFocusEnterHandler=function(e){dn(oe(Ht,"pages.registerFocusEnterHandler"),"focusEnter",e,[],(()=>{if(!l())throw E}))},e.setCurrentFrame=c,e.initializeWithFrameContext=function(e,t,n){Ye(),Pt(oe(Ht,"pages.initializeWithFrameContext"),n).then((()=>t&&t())),c(e)},e.getConfig=function(){return Jt(oe(Ht,"pages.getConfig."))},e.navigateCrossDomain=function(e){return _t(oe(Ht,"pages.navigateCrossDomain"),e)},e.navigateToApp=function(e){return new Promise((t=>{if(ze(Te,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!l())throw E;const n=oe(Ht,"pages.navigateToApp");if(Te.isLegacyTeams){t(Hn(n,"executeDeepLink",_(Qt(e)?e:Xt(e))))}else{t(Hn(n,"pages.navigateToApp",Qt(e)?Yt(e):e))}}))},e.shareDeepLink=function(e){return qt(oe(Ht,"pages.shareDeepLink"),e)},e.registerFullScreenHandler=function(e){dn(oe(Ht,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],(()=>{if(!Ke(e)&&!l())throw E}))},e.isSupported=l,function(e){e.navigateToTab=function(e){return Vt(oe(Ht,"pages.tabs.navigateToTab"),e)},e.getTabInstances=function(e){return jt(oe(Ht,"pages.tabs.getTabInstances"),e)},e.getMruTabInstances=function(e){return zt(oe(Ht,"pages.tabs.getMruTabInstances"),e)},e.isSupported=function(){return!(!ze(Te)||!Te.supports.pages)&&!!Te.supports.pages.tabs}}(r=e.tabs||(e.tabs={})),function(e){let t,n;function r(e,n,r){!Ke(n)&&ze(Te,h.settings),r&&r(),t=n,!Ke(n)&&qn(e,"registerHandler",["save"])}function o(e,t,r){!Ke(t)&&ze(Te,h.remove,h.settings),r&&r(),n=t,!Ke(t)&&qn(e,"registerHandler",["remove"])}function i(e){const n=new a(e);t?t(n):Ln.childWindow?br("settings.save",[e]):n.notifySuccess()}e.initialize=function(){un(oe(Ht,"pages.config.registerSettingsSaveHandler"),"settings.save",i,!1),un(oe(Ht,"pages.config.registerSettingsRemoveHandler"),"settings.remove",s,!1)},e.setValidityState=function(e){return Gt(oe(Ht,"pages.config.setValidityState"),e)},e.setConfig=function(e){return Kt(oe(Ht,"pages.config.setConfig"),e)},e.registerOnSaveHandler=function(e){r(oe(Ht,"pages.config.registerOnSaveHandler"),e,(()=>{if(!Ke(e)&&!c())throw E}))},e.registerOnSaveHandlerHelper=r,e.registerOnRemoveHandler=function(e){o(oe(Ht,"pages.config.registerOnRemoveHandler"),e,(()=>{if(!Ke(e)&&!c())throw E}))},e.registerOnRemoveHandlerHelper=o,e.registerChangeConfigHandler=function(e){dn(oe(Ht,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[h.content],(()=>{if(!c())throw E}))};class a{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),qn(oe(Ht,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),qn(oe(Ht,"pages.saveEvent.notifyFailure"),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")}}function s(){const e=new u;n?n(e):Ln.childWindow?br("settings.remove",[]):e.notifySuccess()}class u{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),qn(oe(Ht,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),qn(oe(Ht,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")}}function c(){return!(!ze(Te)||!Te.supports.pages)&&!!Te.supports.pages.config}e.isSupported=c}(o=e.config||(e.config={})),function(e){let t;function n(){return Bt(oe(Ht,"pages.backStack.navigateBack"))}function r(e,n,r){!Ke(n)&&ze(Te),r&&r(),t=n,!Ke(n)&&qn(e,"registerHandler",["backButton"])}function o(){t&&t()||(Ln.childWindow?br("backButtonPress",[]):n())}function i(){return!(!ze(Te)||!Te.supports.pages)&&!!Te.supports.pages.backStack}e._initialize=function(){un(oe(Ht,"pages.backStack.registerBackButtonPressHandler"),"backButtonPress",o,!1)},e.navigateBack=n,e.registerBackButtonHandler=function(e){r(oe(Ht,"pages.backStack.registerBackButtonHandler"),e,(()=>{if(!Ke(e)&&!i())throw E}))},e.registerBackButtonHandlerHelper=r,e.isSupported=i}(i=e.backStack||(e.backStack={})),function(e){function t(){return!(!ze(Te)||!Te.supports.pages)&&!!Te.supports.pages.fullTrust}e.enterFullscreen=function(){if(ze(Te,h.content),!t())throw E;qn(oe(Ht,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])},e.exitFullscreen=function(){if(ze(Te,h.content),!t())throw E;qn(oe(Ht,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])},e.isSupported=t}(a=e.fullTrust||(e.fullTrust={})),function(e){function t(){return!(!ze(Te)||!Te.supports.pages)&&!!Te.supports.pages.appButton}e.onClick=function(e){dn(oe(Ht,"pages.appButton.onClick"),"appButtonClick",e,[h.content],(()=>{if(!t())throw E}))},e.onHoverEnter=function(e){dn(oe(Ht,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[h.content],(()=>{if(!t())throw E}))},e.onHoverLeave=function(e){dn(oe(Ht,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[h.content],(()=>{if(!t())throw E}))},e.isSupported=t}(s=e.appButton||(e.appButton={})),function(e){function t(){return!(!ze(Te)||!Te.supports.pages)&&!!Te.supports.pages.currentApp}e.navigateTo=function(e){return new Promise((n=>{if(ze(Te,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!t())throw E;n(Bn(oe(Ht,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))}))},e.navigateToDefaultPage=function(){return new Promise((e=>{if(ze(Te,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!t())throw E;e(Bn(oe(Ht,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))}))},e.isSupported=t}(u=e.currentApp||(e.currentApp={}))}(Zt||(Zt={}));var en=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const tn=re("handlers");class nn{static initializeHandlers(){nn.handlers.themeChange=pn,nn.handlers.load=gn,nn.handlers.beforeUnload=vn,Zt.backStack._initialize()}static uninitializeHandlers(){nn.handlers={},nn.themeChangeHandler=null,nn.loadHandler=null,nn.beforeUnloadHandler=null,nn.beforeSuspendOrTerminateHandler=null,nn.resumeHandler=null}}function rn(){nn.initializeHandlers()}function on(){nn.uninitializeHandlers()}nn.handlers={},nn.themeChangeHandler=null,nn.loadHandler=null,nn.beforeUnloadHandler=null,nn.beforeSuspendOrTerminateHandler=null,nn.resumeHandler=null;const an=tn.extend("callHandler");function sn(e,t){const n=nn.handlers[e];if(n){an("Invoking the registered handler for message %s with arguments %o",e,t);return[!0,n.apply(this,t)]}return Ln.childWindow?(br(e,t),[!1,void 0]):(an("Handler for action message %s not found.",e),[!1,void 0])}function un(e,t,n,r=!0,o=[]){n?(nn.handlers[t]=n,r&&qn(e,"registerHandler",[t,...o])):delete nn.handlers[t]}function cn(e){delete nn.handlers[e]}function ln(e){return null!=nn.handlers[e]}function dn(e,t,n,r,o){n&&ze(Te,...r),o&&o(),un(e,t,n)}function fn(e,t){nn.themeChangeHandler=t,!Ke(t)&&qn(e,"registerHandler",["themeChange"])}function pn(e){nn.themeChangeHandler&&nn.themeChangeHandler(e),Ln.childWindow&&br("themeChange",[e])}function hn(e,t){nn.loadHandler=t,!Ke(t)&&qn(e,"registerHandler",["load"])}function gn(e){const t=mn(e);nn.resumeHandler?(nn.resumeHandler(t),Ln.childWindow&&br("load",[t])):nn.loadHandler&&(nn.loadHandler(e),Ln.childWindow&&br("load",[e]))}function mn(e){return{entityId:e.entityId,contentUrl:new URL(e.contentUrl)}}function wn(e,t){nn.beforeUnloadHandler=t,!Ke(t)&&qn(e,"registerHandler",["beforeUnload"])}function vn(){return en(this,void 0,void 0,(function*(){const e=()=>{qn(oe("v2","handleBeforeUnload"),"readyToUnload",[])};nn.beforeSuspendOrTerminateHandler?(yield nn.beforeSuspendOrTerminateHandler(),Ln.childWindow?br("beforeUnload"):e()):nn.beforeUnloadHandler&&nn.beforeUnloadHandler(e)||(Ln.childWindow?br("beforeUnload"):e())}))}function yn(e){nn.beforeSuspendOrTerminateHandler=e,!Ke(e)&&qn(oe("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}function Cn(e){nn.resumeHandler=e,!Ke(e)&&qn(oe("v2","registerOnResumeHandler"),"registerHandler",["load"])}var bn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const Sn=e=>{const{uuid:t}=e,n=bn(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})},En=e=>{const{uuidAsString:t}=e,n=bn(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new Y(t):void 0})},An=e=>{const{uuidAsString:t}=e,n=bn(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new Y(t):void 0})},In=e=>{const{uuid:t}=e,n=bn(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})},Tn=re("nestedAppAuthUtils"),Pn=Tn.extend("tryPolyfillWithNestedAppAuthBridge");function Rn(e,t,n){var r;const o=Pn;if(ye.isFramelessWindow)return void o("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void o("Cannot polyfill nestedAppAuthBridge as current window does not exist");const i=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!i||!(null===(r=i.supports)||void 0===r?void 0:r.nestedAppAuth))return void o("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");const a=t;if(a.nestedAppAuthBridge)return void o("nestedAppAuthBridge already exists on current window, skipping polyfill");const s=On(a,n);s&&(a.nestedAppAuthBridge=s)}const Fn=Tn.extend("createNestedAppAuthBridge");function On(e,t){const n=Fn;if(!e)return n("nestedAppAuthBridge cannot be created as current window does not exist"),null;const{onMessage:r,sendPostMessage:o}=t,i=e=>t=>r(t,e);return{addEventListener:(t,r)=>{"message"===t?e.addEventListener(t,i(r)):n(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{const t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();t&&"object"==typeof t&&"NestedAppAuthRequest"===t.messageType?o(e):n("Unrecognized data format received by app, message being ignored. Message: %o",e)},removeEventListener:(t,n)=>{e.removeEventListener(t,i(n))}}}var kn=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const Mn=re("communication");class Ln{}class Un{}function Nn(e,t){if(Un.messageListener=e=>Yn(e),Ln.currentWindow=Ln.currentWindow||z(),Ln.parentWindow=Ln.currentWindow.parent!==Ln.currentWindow.self?Ln.currentWindow.parent:Ln.currentWindow.opener,Ln.topWindow=Ln.currentWindow.top,(Ln.parentWindow||e)&&Ln.currentWindow.addEventListener("message",Un.messageListener,!1),!Ln.parentWindow){const e=Ln.currentWindow;if(!e.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));ye.isFramelessWindow=!0,e.onNativeMessage=cr}try{return Ln.parentOrigin="*",Vn(t,"initialize",[_e,Se,e]).then((([e,t,n,r])=>(Rn(r,Ln.currentWindow,{onMessage:tr,sendPostMessage:Gn}),{context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r})))}finally{Ln.parentOrigin=null}}function xn(){Ln.currentWindow&&Ln.currentWindow.removeEventListener("message",Un.messageListener,!1),Ln.currentWindow=null,Ln.parentWindow=null,Ln.parentOrigin=null,Ln.childWindow=null,Ln.childOrigin=null,Un.parentMessageQueue=[],Un.childMessageQueue=[],Un.nextMessageId=0,Un.callbacks.clear(),Un.promiseCallbacks.clear(),Un.portCallbacks.clear(),Un.legacyMessageIdsToUuidMap={}}function Dn(e,t,...n){return Vn(e,t,n).then((([e])=>e))}function Hn(e,t,...n){return Vn(e,t,n).then((([e,t])=>{if(!e)throw new Error(t)}))}function _n(e,t,n,...r){return Vn(e,t,r).then((([e,t])=>{if(!e)throw new Error(t||n)}))}function Bn(e,t,...n){return Vn(e,t,n).then((([e,t])=>{if(e)throw e;return t}))}function Vn(e,t,n=void 0){if(!ie(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise((r=>{r(zn(Qn(e,t,n).uuid))}))}function Wn(e,t,n=void 0){if(!ie(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return jn(Qn(e,t,n).uuid)}function jn(e){return new Promise(((t,n)=>{Un.portCallbacks.set(e,((e,r)=>{e instanceof MessagePort?t(e):n(r&&r.length>0?r[0]:new Error("Host responded without port or error details."))}))}))}function zn(e){return new Promise((t=>{Un.promiseCallbacks.set(e,t)}))}function qn(e,t,n,r){let o;if(n instanceof Function?r=n:n instanceof Array&&(o=n),!ie(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);const i=Qn(e,t,o);r&&Un.callbacks.set(i.uuid,r)}Un.parentMessageQueue=[],Un.childMessageQueue=[],Un.topMessageQueue=[],Un.nextMessageId=0,Un.callbacks=new Map,Un.promiseCallbacks=new Map,Un.portCallbacks=new Map,Un.legacyMessageIdsToUuidMap={};const $n=Mn.extend("sendNestedAuthRequestToTopWindow");function Gn(e){const t=$n,n=Ln.topWindow,r=Er(e);return t("Message %s information: %o",Tr(r),{actionName:r.func}),Kn(n,r)}const Jn=Mn.extend("sendRequestToTargetWindowHelper");function Kn(e,t){const n=Jn,r=mr(e),o=Sn(t);if(ye.isFramelessWindow)Ln.currentWindow&&Ln.currentWindow.nativeInterface&&(n("Sending message %s to %s via framelessPostMessage interface",Tr(o),r),Ln.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(o)));else{const i=gr(e);e&&i?(n("Sending message %s to %s via postMessage",Tr(o),r),e.postMessage(o,i)):(n("Adding message %s to %s message queue",Tr(o),r),hr(e).push(t))}return t}const Zn=Mn.extend("sendMessageToParentHelper");function Qn(e,t,n){const r=Zn,o=Ln.parentWindow,i=Sr(e,t,n);return r("Message %s information: %o",Tr(i),{actionName:t,args:n}),Kn(o,i)}const Xn=Mn.extend("processIncomingMessage");function Yn(e){return kn(this,void 0,void 0,(function*(){if(!e||!e.data||"object"!=typeof e.data)return void Xn("Unrecognized message format received by app, message being ignored. Message: %o",e);const t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;return rr(t,n).then((r=>{r?(or(t,n),t===Ln.parentWindow?cr(e):t===Ln.childWindow&&fr(e)):Xn("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o",e,t,n)}))}))}const er=Mn.extend("processAuthBridgeMessage");function tr(e,t){var n,r;const o=er;if(!e||!e.data||"object"!=typeof e.data)return void o("Unrecognized message format received by app, message being ignored. Message: %o",e);const{args:i}=e.data,[,a]=null!=i?i:[],s=(()=>{try{return JSON.parse(a)}catch(e){return null}})();if(!s||"object"!=typeof s||"NestedAppAuthResponse"!==s.messageType)return void o("Unrecognized data format received by app, message being ignored. Message: %o",e);const u=e.source||(null===(n=null==e?void 0:e.originalEvent)||void 0===n?void 0:n.source),c=e.origin||(null===(r=null==e?void 0:e.originalEvent)||void 0===r?void 0:r.origin);u?rr(u,c)?(Ln.topWindow&&!Ln.topWindow.closed&&u!==Ln.topWindow||(Ln.topWindow=u,Ln.topOrigin=c),Ln.topWindow&&Ln.topWindow.closed&&(Ln.topWindow=null,Ln.topOrigin=null),vr(Ln.topWindow),t(a)):o("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):o("Message being ignored by app because it is coming for a target that is null")}const nr=Mn.extend("shouldProcessIncomingMessage");function rr(e,t){return kn(this,void 0,void 0,(function*(){if(Ln.currentWindow&&e===Ln.currentWindow)return nr("Should not process message because it is coming from the current window"),!1;if(Ln.currentWindow&&Ln.currentWindow.location&&t&&t===Ln.currentWindow.location.origin)return!0;{let e;try{e=new URL(t)}catch(e){return nr("Message has an invalid origin of %s",t),!1}const n=yield ot(e);return n||nr("Message has an invalid origin of %s",t),n}}))}function or(e,t){ye.isFramelessWindow||Ln.parentWindow&&!Ln.parentWindow.closed&&e!==Ln.parentWindow?Ln.childWindow&&!Ln.childWindow.closed&&e!==Ln.childWindow||(Ln.childWindow=e,Ln.childOrigin=t):(Ln.parentWindow=e,Ln.parentOrigin=t),Ln.parentWindow&&Ln.parentWindow.closed&&(Ln.parentWindow=null,Ln.parentOrigin=null),Ln.childWindow&&Ln.childWindow.closed&&(Ln.childWindow=null,Ln.childOrigin=null),vr(Ln.parentWindow),vr(Ln.childWindow)}const ir=Mn.extend("handleIncomingMessageFromParent");function ar(e){const t=ir;if(!e.uuid)return Un.legacyMessageIdsToUuidMap[e.id];{const t=e.uuid,n=sr(Un.callbacks,t);if(n)return n;const r=sr(Un.promiseCallbacks,t);if(r)return r;const o=sr(Un.portCallbacks,t);if(o)return o}t("Received message %s that failed to produce a callbackId",Tr(e))}function sr(e,t){if(t){const n=[...e].find((([e,n])=>e.toString()===t.toString()));if(n)return n[0]}}function ur(e,t){const n=sr(t,e.uuid);n&&t.delete(n),e.uuid?Un.legacyMessageIdsToUuidMap={}:delete Un.legacyMessageIdsToUuidMap[e.id]}function cr(e){const t=ir;if("id"in e.data&&"number"==typeof e.data.id){const n=e.data,r=An(n),o=ar(r);if(o){const n=Un.callbacks.get(o);t("Received a response from parent for message %s",o.toString()),n&&(t("Invoking the registered callback for message %s with arguments %o",o.toString(),r.args),n.apply(null,[...r.args,r.isPartialResponse]),lr(e)||(t("Removing registered callback for message %s",o.toString()),ur(r,Un.callbacks)));const i=Un.promiseCallbacks.get(o);i&&(t("Invoking the registered promise callback for message %s with arguments %o",o.toString(),r.args),i(r.args),t("Removing registered promise callback for message %s",o.toString()),ur(r,Un.promiseCallbacks));const a=Un.portCallbacks.get(o);if(a){let n;t("Invoking the registered port callback for message %s with arguments %o",o.toString(),r.args),e.ports&&e.ports[0]instanceof MessagePort&&(n=e.ports[0]),a(n,r.args),t("Removing registered port callback for message %s",o.toString()),ur(r,Un.portCallbacks)}r.uuid&&(Un.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&"string"==typeof e.data.func){const n=e.data;t('Received a message from parent %s, action: "%s"',Tr(n),n.func),sn(n.func,n.args)}else t("Received an unknown message: %O",e)}function lr(e){return!0===e.data.isPartialResponse}const dr=Mn.extend("handleIncomingMessageFromChild");function fr(e){if("id"in e.data&&"func"in e.data){const t=En(e.data),[n,r]=sn(t.func,t.args);n&&void 0!==r?(dr("Returning message %s from child back to child, action: %s.",Tr(t),t.func),Cr(t.id,t.uuid,Array.isArray(r)?r:[r])):(dr("Relaying message %s from child to parent, action: %s. Relayed message will have a new id.",Tr(t),t.func),qn(oe("v2","tasks.startTask"),t.func,t.args,((...e)=>{if(Ln.childWindow){const n=e.pop();dr("Message from parent being relayed to child, id: %s",Tr(t)),Cr(t.id,t.uuid,e,n)}})))}}function pr(){return Ln.topWindow!==Ln.parentWindow}function hr(e){return e===Ln.topWindow&&pr()?Un.topMessageQueue:e===Ln.parentWindow?Un.parentMessageQueue:e===Ln.childWindow?Un.childMessageQueue:[]}function gr(e){return e===Ln.topWindow&&pr()?Ln.topOrigin:e===Ln.parentWindow?Ln.parentOrigin:e===Ln.childWindow?Ln.childOrigin:null}function mr(e){return e===Ln.topWindow&&pr()?"top":e===Ln.parentWindow?"parent":e===Ln.childWindow?"child":null}const wr=Mn.extend("flushMessageQueue");function vr(e){const t=gr(e),n=hr(e),r=mr(e);for(;e&&t&&n.length>0;){const o=n.shift();if(o){const n=Sn(o);wr("Flushing message %s from %s message queue via postMessage.",Tr(n),r),e.postMessage(n,t)}}}function yr(e,t){let n;n=Ln.currentWindow.setInterval((()=>{0===hr(e).length&&(clearInterval(n),t())}),100)}function Cr(e,t,n,r){const o=Ln.childWindow,i=Ar(e,t,n,r),a=In(i),s=gr(o);o&&s&&o.postMessage(a,s)}function br(e,t){const n=Ln.childWindow,r=Ir(e,t),o=gr(n);n&&o?n.postMessage(r,o):hr(n).push(r)}function Sr(e,t,n){const r=Un.nextMessageId++,o=new Y;return Un.legacyMessageIdsToUuidMap[r]=o,{id:r,uuid:o,func:t,timestamp:Date.now(),args:n||[],apiVersionTag:e}}function Er(e){const t=Un.nextMessageId++,n=new Y;return Un.legacyMessageIdsToUuidMap[t]=n,{id:t,uuid:n,func:"nestedAppAuth.execute",timestamp:Date.now(),args:[],data:e}}function Ar(e,t,n,r){return{id:e,uuid:t,args:n||[],isPartialResponse:r}}function Ir(e,t){return{func:e,args:t||[]}}function Tr(e){return"uuidAsString"in e?`${e.uuidAsString} (legacy id: ${e.id})`:"uuid"in e&&void 0!==e.uuid?`${e.uuid.toString()} (legacy id: ${e.id})`:`legacy id: ${e.id} (no uuid)`}var Pr,Rr,Fr,Or;!function(e){function t(){return!(!ze(Te)||!Te.supports.logs)}e.registerGetLogHandler=function(e){if(!Ke(e)&&ze(Te),!Ke(e)&&!t())throw E;e?un(oe("v1","log.request"),"log.request",(()=>{const t=e();qn(oe("v1","log.receive"),"log.receive",[t])})):cn("log.request")},e.isSupported=t}(Pr||(Pr={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Rr||(Rr={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Fr||(Fr={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(Or||(Or={}));const kr="v1";function Mr(e,t){ze(Te),qn(oe(kr,"uploadCustomApp"),"uploadCustomApp",[e],t||k())}function Lr(e,t,n){ze(Te),qn(oe(kr,"sendCustomMessage"),e,t,n)}function Ur(e,t){if(ze(Te),!Ln.childWindow)throw new Error("The child window has not yet been initialized or is not present");br(e,t)}function Nr(e,t){ze(Te),un(oe(kr,"registerCustomHandler"),e,((...e)=>t.apply(this,e)))}function xr(e,t){ze(Te),un(oe(kr,"registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function Dr(e){ze(Te,h.content,h.task);const t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];qn(oe(kr,"openFilePreview"),"openFilePreview",t)}const Hr="v1";var _r,Br;!function(e){function t(){return!(!ze(Te)||!Te.supports.conversations)}e.openConversation=function(e){return new Promise((n=>{if(ze(Te,h.content),!t())throw E;const r=Hn(oe(Hr,"conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&un(oe(Hr,"conversations.registerStartConversationHandler"),"startConversation",((t,n,r,o)=>{var i;return null===(i=e.onStartConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),e.onCloseConversation&&un(oe(Hr,"conversations.registerCloseConversationHandler"),"closeConversation",((t,n,r,o)=>{var i;return null===(i=e.onCloseConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),n(r)}))},e.closeConversation=function(){if(ze(Te,h.content),!t())throw E;qn(oe(Hr,"conversations.closeConversation"),"conversations.closeConversation"),cn("startConversation"),cn("closeConversation")},e.getChatMembers=function(){return new Promise((e=>{if(ze(Te),!t())throw E;e(Dn(oe(Hr,"conversations.getChatMember"),"getChatMembers"))}))},e.isSupported=t}(_r||(_r={})),function(e){let t;!function(e){function t(){var e;return ze(Te)&&!!(null===(e=Te.hostVersionsInfo)||void 0===e?void 0:e.appEligibilityInformation)}e.isSupported=t,e.getEligibilityInfo=function(){if(ze(Te),!t())throw E;return Te.hostVersionsInfo.appEligibilityInformation}}(t=e.eligibility||(e.eligibility={}))}(Br||(Br={}));const Vr="v2";var Wr;!function(e){let t,n,r;function o(n){if(n.requestType===t.ActionExecuteInvokeRequest){const t=n;if(t.type!==e.ActionExecuteInvokeRequestType){throw{errorCode:r.INTERNAL_ERROR,message:`Invalid action type ${t.type}. Action type must be "${e.ActionExecuteInvokeRequestType}"`}}}else if(n.requestType===t.QueryMessageExtensionRequest){if(n.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(n.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(const e of n.parameters){if(e.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(e.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function i(){return!(!ze(Te)||!Te.supports.externalAppAuthentication)}e.isActionExecuteResponse=function(t){const n=t;return n.responseType===e.InvokeResponseType.ActionExecuteInvokeResponse&&void 0!==n.value&&void 0!==n.statusCode&&void 0!==n.type},e.ActionExecuteInvokeRequestType="Action.Execute",function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"}(t=e.OriginalRequestType||(e.OriginalRequestType={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(n=e.InvokeResponseType||(e.InvokeResponseType={})),e.isInvokeError=function(t){if("object"!=typeof t||null===t)return!1;const n=t;return Object.values(e.InvokeErrorCode).includes(n.errorCode)&&(void 0===n.message||"string"==typeof n.message)},function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(r=e.InvokeErrorCode||(e.InvokeErrorCode={})),e.authenticateAndResendRequest=function(e,t,n){if(ze(Te,h.content),!i())throw E;const r=new lt(e);return o(n),Vn(oe(Vr,"externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[r.toString(),n,t.url.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))},e.authenticateWithSSO=function(e,t){if(ze(Te,h.content),!i())throw E;const n=new lt(e);return Vn(oe(Vr,"externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[n.toString(),t.claims,t.silent]).then((([e,t])=>{if(!e)throw t}))},e.authenticateWithSSOAndResendRequest=function(e,t,n){if(ze(Te,h.content),!i())throw E;const r=new lt(e);return o(n),Vn(oe(Vr,"externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[r.toString(),n,t.claims,t.silent]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))},e.authenticateWithOauth2=function(e,t,n){if(ze(Te,h.content),!i())throw E;return $(e,new Error("titleId is Invalid.")),$(t,new Error("oauthConfigId is Invalid.")),Vn(oe(Vr,"externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,n.width,n.height,n.isExternal]).then((([e,t])=>{if(!e)throw t}))},e.authenticateWithPowerPlatformConnectorPlugins=function(e,t,n){if(ze(Te,h.content),!i())throw E;return $(e,new Error("titleId is Invalid.")),t&&G(t),Vn(oe(Vr,"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,null==t?void 0:t.toString(),null==n?void 0:n.width,null==n?void 0:n.height,null==n?void 0:n.isExternal]).then((([e,t])=>{if(!e)throw t}))},e.isSupported=i}(Wr||(Wr={}));var jr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const zr="v2";var qr;!function(e){function t(){return!(!ze(Te)||!Te.supports.externalAppAuthenticationForCEA)}function n(e){if(e.type!==Wr.ActionExecuteInvokeRequestType){throw{errorCode:Wr.InvokeErrorCode.INTERNAL_ERROR,message:`Invalid action type ${e.type}. Action type must be "${Wr.ActionExecuteInvokeRequestType}"`}}}e.authenticateWithSSO=function(e,n,r){return jr(this,void 0,void 0,(function*(){if(ze(Te,h.content),!t())throw E;$(n,new Error("conversation id is not valid."));const o=yield Dn(oe(zr,"externalAppAuthenticationForCEA.authenticateWithSSO"),"externalAppAuthenticationForCEA.authenticateWithSSO",e.toString(),n,r.claims,r.silent);if(o)throw o}))},e.authenticateWithOauth=function(e,n,r){return jr(this,void 0,void 0,(function*(){if(ze(Te,h.content),!t())throw E;$(n,new Error("conversation id is not valid."));const o=yield Dn(oe(zr,"externalAppAuthenticationForCEA.authenticateWithOauth"),"externalAppAuthenticationForCEA.authenticateWithOauth",e.toString(),n,r.url.href,r.width,r.height,r.isExternal);if(o)throw o}))},e.authenticateAndResendRequest=function(e,o,i,a){return jr(this,void 0,void 0,(function*(){if(ze(Te,h.content),!t())throw E;$(o,new Error("conversation id is not valid.")),n(a);const s=yield Dn(oe(zr,"externalAppAuthenticationForCEA.authenticateAndResendRequest"),"externalAppAuthenticationForCEA.authenticateAndResendRequest",e.toString(),o,a,i.url.href,i.width,i.height,i.isExternal);if(Wr.isActionExecuteResponse(s))return s;throw Wr.isInvokeError(s)?s:r}))},e.authenticateWithSSOAndResendRequest=function(e,o,i,a){return jr(this,void 0,void 0,(function*(){if(ze(Te,h.content),!t())throw E;$(o,new Error("conversation id is not valid.")),n(a);const s=yield Dn(oe(zr,"externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"),"externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",e.toString(),o,a,i.claims,i.silent);if(Wr.isActionExecuteResponse(s))return s;throw Wr.isInvokeError(s)?s:r}))},e.isSupported=t;const r={errorCode:Wr.InvokeErrorCode.INTERNAL_ERROR,message:"No valid response received"}}(qr||(qr={}));var $r;!function(e){let t,n;function r(){return!(!ze(Te)||!Te.supports.externalAppCardActions)}!function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"}(t=e.ActionOpenUrlType||(e.ActionOpenUrlType={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(n=e.ActionOpenUrlErrorCode||(e.ActionOpenUrlErrorCode={})),e.processActionSubmit=function(e,t){if(ze(Te,h.content),!r())throw E;const n=new lt(e);return Vn(oe("v2","externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[n.toString(),t]).then((([e,t])=>{if(!e)throw t}))},e.processActionOpenUrl=function(e,t,n){if(ze(Te,h.content),!r())throw E;const o=new lt(e);return Vn(oe("v2","externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[o.toString(),t.href,n]).then((([e,t])=>{if(e)throw e;return t}))},e.isSupported=r}($r||($r={}));var Gr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};var Jr;!function(e){function t(){return!(!ze(Te)||!Te.supports.externalAppCardActionsForCEA)}e.processActionOpenUrl=function(e,n,r){return Gr(this,void 0,void 0,(function*(){if(ze(Te,h.content),!t())throw E;$(n,new Error("conversation id is not valid."));const[o,i]=yield Vn(oe("v2","externalAppCardActionsForCEA.processActionOpenUrl"),"externalAppCardActionsForCEA.processActionOpenUrl",[e.toString(),n,r.href]);if(o)throw o;return i}))},e.processActionSubmit=function(e,n,r){return Gr(this,void 0,void 0,(function*(){if(ze(Te,h.content),!t())throw E;$(n,new Error("conversation id is not valid."));const o=yield Dn(oe("v2","externalAppCardActionsForCEA.processActionSubmit"),"externalAppCardActionsForCEA.processActionSubmit",e.toString(),n,r);if(o)throw o}))},e.isSupported=t}(Jr||(Jr={}));var Kr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};var Zr;!function(e){function t(){return!(!ze(Te)||!Te.supports.externalAppCommands)}e.processActionCommand=function(e,n,r){return Kr(this,void 0,void 0,(function*(){if(ze(Te,h.content),!t())throw E;const o=new lt(e),[i,a]=yield Vn(oe("v2","externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[o.toString(),n,r]);if(i)throw i;return a}))},e.isSupported=t}(Zr||(Zr={}));const Qr="v1";var Xr;!function(e){let t,n,r,o,a,s;function u(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(t=e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(n=e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(e){e.ClassMaterials="classMaterials"}(r=e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(e){e.Readonly="readonly"}(o=e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(a=e.FileDownloadStatus||(e.FileDownloadStatus={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(s=e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(e,t){if(ze(Te,h.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");qn(oe(Qr,"files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if(ze(Te,h.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");qn(oe(Qr,"files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if(ze(Te,h.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");qn(oe(Qr,"files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if(ze(Te,h.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");qn(oe(Qr,"files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if(ze(Te,h.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");qn(oe(Qr,"files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,n])},e.getExternalProviders=function(e=!1,t){if(ze(Te,h.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");qn(oe(Qr,"files.getExternalProviders"),"files.getExternalProviders",[e],t)},e.copyMoveFiles=function(e,t,n,r,o=!1,i){if(ze(Te,h.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!i)throw new Error("[files.copyMoveFiles] callback cannot be null");qn(oe(Qr,"files.copyMoveFiles"),"files.copyMoveFiles",[e,t,n,r,o],i)},e.getFileDownloads=function(e){if(ze(Te,h.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");qn(oe(Qr,"files.getFileDownloads"),"files.getFileDownloads",[],e)},e.openDownloadFolder=function(e=void 0,t){if(ze(Te,h.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");qn(oe(Qr,"files.openDownloadFolder"),"files.openDownloadFolder",[e],t)},e.addCloudStorageProvider=function(e){if(ze(Te,h.content),!e)throw u(i.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");qn(oe(Qr,"files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)},e.removeCloudStorageProvider=function(e,t){if(ze(Te,h.content),!t)throw u(i.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw u(i.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");qn(oe(Qr,"files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)},e.addCloudStorageProviderFile=function(e,t){if(ze(Te,h.content),!t)throw u(i.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw u(i.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");qn(oe(Qr,"files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)},e.renameCloudStorageProviderFile=function(e,t){if(ze(Te,h.content),!t)throw u(i.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw u(i.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");qn(oe(Qr,"files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)},e.deleteCloudStorageProviderFile=function(e,t){if(ze(Te,h.content),!t)throw u(i.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw u(i.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");qn(oe(Qr,"files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)},e.downloadCloudStorageProviderFile=function(e,t){if(ze(Te,h.content),!t)throw u(i.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw u(i.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");qn(oe(Qr,"files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)},e.uploadCloudStorageProviderFile=function(e,t){if(ze(Te,h.content),!t)throw u(i.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw u(i.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw u(i.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");qn(oe(Qr,"files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)},e.registerCloudStorageProviderListChangeHandler=function(e){if(ze(Te),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");un(oe(Qr,"files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)},e.registerCloudStorageProviderContentChangeHandler=function(e){if(ze(Te),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");un(oe(Qr,"files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}}(Xr||(Xr={}));const Yr="v1";var eo;!function(e){function t(){return!(!ze(Te)||!Te.supports.meetingRoom)}e.getPairedMeetingRoomInfo=function(){return new Promise((e=>{if(ze(Te),!t())throw E;e(Bn(oe(Yr,"meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))}))},e.sendCommandToPairedMeetingRoom=function(e){return new Promise((n=>{if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(ze(Te),!t())throw E;n(Bn(oe(Yr,"meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))}))},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(ze(Te),!t())throw E;un(oe(Yr,"meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",(t=>{ze(Te),e(t)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(ze(Te),!t())throw E;un(oe(Yr,"meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",(t=>{ze(Te),e(t)}))},e.isSupported=t}(eo||(eo={}));var to,no;!function(e){function t(){return!(!ze(Te)||!Te.supports.notifications)}e.showNotification=function(e){if(ze(Te,h.content),!t())throw E;qn(oe("v1","notifications.showNotification"),"notifications.showNotification",[e])},e.isSupported=t}(to||(to={})),function(e){function t(){return!(!ze(Te)||!Te.supports.otherAppStateChange)}e.registerAppInstallationHandler=function(e){if(!t())throw new Error(i.NOT_SUPPORTED_ON_PLATFORM.toString());if(Ke(e))throw new Error(i.INVALID_ARGUMENTS.toString());un(oe("v2","otherApp.install"),"otherApp.install",e)},e.unregisterAppInstallationHandler=function(){if(!t())throw new Error(i.NOT_SUPPORTED_ON_PLATFORM.toString());qn(oe("v2","otherApp.unregisterInstall"),"otherApp.unregisterInstall"),cn("otherApp.install")},e.isSupported=t}(no||(no={}));const ro="v1";var oo;!function(e){let t,n,r;function o(){return!(!ze(Te)||!Te.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(t=e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(n=e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(r=e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(ze(Te,h.sidePanel),!o())throw E;qn(oe(ro,"remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(ze(Te,h.sidePanel),!o())throw E;qn(oe(ro,"remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)},e.sendControlCommand=function(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(ze(Te,h.sidePanel),!o())throw E;qn(oe(ro,"remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(ze(Te,h.sidePanel),!o())throw E;qn(oe(ro,"remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(ze(Te,h.sidePanel),!o())throw E;un(oe(ro,"remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(ze(Te,h.sidePanel),!o())throw E;un(oe(ro,"remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(ze(Te,h.sidePanel),!o())throw E;un(oe(ro,"remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(ze(Te,h.sidePanel),!o())throw E;un(oe(ro,"remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)},e.isSupported=o}(oo||(oo={}));var io;!function(e){function t(){return!(!ze(Te)||!Te.supports.appEntity)}e.selectAppEntity=function(e,n,r,o){if(ze(Te,h.content),!t())throw E;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!o)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");qn(oe("v1","appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,n,r],o)},e.isSupported=t}(io||(io={}));const ao="v1";var so;!function(e){let t,n;function r(){return!(!ze(Te)||!Te.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(t=e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,t){if(ze(Te,h.content),!r())throw E;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");qn(oe(ao,"teams.getTeamChannels"),"teams.getTeamChannels",[e],t)},e.refreshSiteUrl=function(e,t){if(ze(Te),!r())throw E;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");qn(oe(ao,"teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)},e.isSupported=r,function(e){let t;function n(){return!(!ze(Te)||!Te.supports.teams)&&!!Te.supports.teams.fullTrust}!function(e){function t(){return!(!ze(Te)||!Te.supports.teams)&&(!!Te.supports.teams.fullTrust&&!!Te.supports.teams.fullTrust.joinedTeams)}e.getUserJoinedTeams=function(e){return new Promise((n=>{if(ze(Te),!t())throw E;if((ye.hostClientType===f.android||ye.hostClientType===f.teamsRoomsAndroid||ye.hostClientType===f.teamsPhones||ye.hostClientType===f.teamsDisplays)&&!qe("2.0.1")){const e={errorCode:i.OLD_PLATFORM};throw new Error(JSON.stringify(e))}n(Dn(oe(ao,"teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))}))},e.isSupported=t}(t=e.joinedTeams||(e.joinedTeams={})),e.getConfigSetting=function(e){return new Promise((t=>{if(ze(Te),!n())throw E;t(Dn(oe(ao,"teams.fullTrust.getConfigSetting"),"getConfigSetting",e))}))},e.isSupported=n}(n=e.fullTrust||(e.fullTrust={}))}(so||(so={}));class uo{static setTimeout(e,t){const n=performance.now(),r=L();return uo.setTimeoutCallbacks[r]={callback:e,timeoutInMs:t,startedAtInMs:n},r}static clearTimeout(e){delete uo.setTimeoutCallbacks[e]}static setInterval(e,t){uo.setTimeout((function n(){e(),uo.setTimeout(n,t)}),t)}static tick(){const e=performance.now(),t=[];for(const n in uo.setTimeoutCallbacks){const r=uo.setTimeoutCallbacks[n];e-r.startedAtInMs>=r.timeoutInMs&&t.push(n)}for(const e of t){uo.setTimeoutCallbacks[e].callback(),delete uo.setTimeoutCallbacks[e]}}}uo.setTimeoutCallbacks={};class co{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,n,r){uo.tick(),this.suitableForThisSession(e,t,n,r)||this.reportAndResetSession(this.getStatistics(),e,r,t,n),this.start()}processEnds(){const e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,n,r){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===r&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n}reportAndResetSession(e,t,n,r,o){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,r,o),this.timeoutId&&uo.clearTimeout(this.timeoutId),this.timeoutId=uo.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,n,r,o)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,n,r,o){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:r,frameHeight:o},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(co.maxSessionTimeoutInMs,2*t.timeoutInMs):co.initialSessionTimeoutInMs}}co.initialSessionTimeoutInMs=1e3,co.maxSessionTimeoutInMs=3e4;const lo="v2";class fo{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new co(fo.distributionBinSize,(e=>this.reportPerformanceEvent(oe(lo,"videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[e])))}startMonitorSlowFrameProcessing(){uo.setInterval((()=>{if(0===this.processedFrameCount)return;const e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent(oe(lo,"videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0}),fo.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var n,r;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(r=this.applyingEffect)||void 0===r?void 0:r.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){uo.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(oe(lo,"videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){const e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(oe(lo,"videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}fo.distributionBinSize=1e3,fo.calculateFPSInterval=1e3;var po=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))},ho=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const go="v2";var mo;!function(e){const t=q()?void 0:new fo(qn);let n,r,o;function i(e){qn(oe(go,"videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function a(e){qn(oe(go,"videoEffects.notifyError"),"video.notifyError",[e])}function s(){return ze(Te)&&!!Te.supports.video&&(!!Te.supports.video.mediaStream||!!Te.supports.video.sharedFrame)}function u(e,n){if(ze(Te,h.sidePanel),!s()||!f())throw E;un(oe(go,"videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(n=>po(this,void 0,void 0,(function*(){const{streamId:r}=n,o=c(e,t);yield yo(r,o,a,t)}))),!1),qn(oe(go,"videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[n])}function c(e,t){return n=>po(this,void 0,void 0,(function*(){const r=n.videoFrame;null==t||t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const o=yield e(n);return null==t||t.reportFrameProcessed(),o}))}function l(e,n){if(ze(Te,h.sidePanel),!s()||!g())throw E;un(oe(go,"videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",(n=>{if(n){const r=n.timestamp;null==t||t.reportStartFrameProcessing(n.width,n.height),e(d(n),(()=>{null==t||t.reportFrameProcessed(),i(r)}),a)}}),!1),qn(oe(go,"videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[n])}function d(e){if("videoFrameBuffer"in e)return e;{const{data:t}=e,n=ho(e,["data"]);return Object.assign(Object.assign({},n),{videoFrameBuffer:t})}}function f(){var e;return ze(Te,h.sidePanel)&&p()&&!!(null===(e=Te.supports.video)||void 0===e?void 0:e.mediaStream)}function p(){var e,t,n,r;return!(!(null===(t=null===(e=z().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(r=null===(n=z().chrome)||void 0===n?void 0:n.webview)||void 0===r?void 0:r.registerTextureStream))}function g(){var e;return ze(Te,h.sidePanel)&&!!(null===(e=Te.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(n=e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(r=e.EffectChangeType||(e.EffectChangeType={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(o=e.EffectFailureReason||(e.EffectFailureReason={})),e.registerForVideoFrame=function(e){if(ze(Te,h.sidePanel),!s())throw E;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(un(oe(go,"videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==t?void 0:t.setFrameProcessTimeLimit(e.timeLimit)),!1),f())u(e.videoFrameHandler,e.config);else{if(!g())throw E;l(e.videoBufferHandler,e.config)}null==t||t.startMonitorSlowFrameProcessing()},e.notifySelectedVideoEffectChanged=function(e,t){if(ze(Te,h.sidePanel),!s())throw E;qn(oe(go,"videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){if(ze(Te,h.sidePanel),!s())throw E;un(oe(go,"videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",Ro(e,t),!1),qn(oe(go,"videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")},e.isSupported=s}(mo||(mo={}));var wo=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const vo="v2";function yo(e,t,n,r){var o,i;return wo(this,void 0,void 0,(function*(){const a=So();!q()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),Eo(yield bo(e,n,r),new Ao(n,t),a.writable)}))}function Co(e,t,n,r){var o,i;return wo(this,void 0,void 0,(function*(){const a=So();!q()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),Eo(yield bo(e,n,r),new Po(n,t),a.writable)}))}function bo(e,t,n){return wo(this,void 0,void 0,(function*(){if(q())throw E;const r=z().chrome;try{null==n||n.reportGettingTextureStream(e);const t=(yield r.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw new Error(`No video track in stream ${e}`);return null==n||n.reportTextureStreamAcquired(),t[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),new Error(`Internal error: can't get video track from stream ${e}`)}}))}function So(){if(q())throw E;const e=window.MediaStreamTrackGenerator;if(!e)throw E;return new e({kind:"video"})}function Eo(e,t,n){new(0,z().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}class Ao{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>wo(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const r=yield this.videoFrameHandler({videoFrame:e}),o=new VideoFrame(r,{timestamp:n});t.enqueue(o),e.close(),r.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")}))}}class Io{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class To{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161,this.ATTRIBUTE_ID_MAP_STREAM_ID=1296320833;const n=new Uint32Array(e);for(let r=0,o=0;r<t;r++){const t=n[o++],r=n[o++],i=n[o++],a=new Uint8Array(e,r,i);this.metadataMap.set(t,a)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}get attributes(){const e=this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);if(void 0===e)return;const t=new Map,n=new TextDecoder("utf-8");let r=0;const o=e[r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24);for(let i=0;i<o&&r<e.length-1;i++){const o=e[++r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24),i=e.findIndex(((e,t,n)=>0==e&&t>r)),a=n.decode(e.slice(++r,i)),s=this.metadataMap.get(o);void 0!==s&&t.set(a,s);r=i+(4-(i-r)%4-1)}return t}}class Po{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>wo(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const{videoFrame:r,metadata:{audioInferenceResult:o,attributes:i}={}}=yield this.extractVideoFrameAndMetadata(e),a=yield this.videoFrameHandler({videoFrame:r,audioInferenceResult:o,attributes:i}),s=new VideoFrame(a,{timestamp:n});t.enqueue(s),r.close(),e.close(),a.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")})),this.extractVideoFrameAndMetadata=e=>wo(this,void 0,void 0,(function*(){if(q())throw E;if("NV12"!==e.format)throw this.notifyError("Unsupported video frame pixel format"),new Error("Unsupported video frame pixel format");const t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(n,{rect:t});const r=new Io(n,this.notifyError),o={x:0,y:r.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-r.multiStreamHeaderRowOffset},i=new ArrayBuffer(o.width*o.height*3/2);yield e.copyTo(i,{rect:o});const a=new To(i,r.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:r.frameRowOffset,width:r.frameWidth,height:r.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult,attributes:a.attributes}}})),un(oe(vo,"videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",(({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e}))}}function Ro(e,t){return(n,r)=>{null==t||t.reportApplyingVideoEffect(n||"",r),e(n,r).then((()=>{null==t||t.reportVideoEffectChanged(n||"",r),qn(oe(vo,"videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,n,void 0,r])})).catch((e=>{const t=e in mo.EffectFailureReason?e:mo.EffectFailureReason.InitializationFailure;qn(oe(vo,"videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,n,t,r])}))}}var Fo=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const Oo="v2";var ko;!function(e){e.frameProcessingTimeoutInMs=2e3;const t=q()?void 0:new fo(qn);let n;function r(){const t=setTimeout((()=>{u(`Frame not processed in ${e.frameProcessingTimeoutInMs}ms`,n.Warn)}),e.frameProcessingTimeoutInMs);return function(){clearTimeout(t)}}function o(e,t){return n=>Fo(this,void 0,void 0,(function*(){const o=n.videoFrame;t.reportStartFrameProcessing(o.codedWidth,o.codedHeight);const i=r(),a=yield e(n);return i(),t.reportFrameProcessed(),a}))}function i(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}function a(){return ze(Te),mo.isSupported()}function s(e){qn(oe(Oo,"videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function u(e,t=n.Warn){qn(oe(Oo,"videoEffectsEx.notifyError"),"video.notifyError",[e,t])}!function(e){e.Fatal="fatal",e.Warn="warn"}(n=e.ErrorLevel||(e.ErrorLevel={})),e.registerForVideoFrame=function(e){var n,c;if(!a())throw E;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(ze(Te,h.sidePanel)){if(un(oe(Oo,"videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==t?void 0:t.setFrameProcessTimeLimit(e)),!1),null===(n=Te.supports.video)||void 0===n?void 0:n.mediaStream)un(oe(Oo,"videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(n=>Fo(this,void 0,void 0,(function*(){const{streamId:r,metadataInTexture:i}=n,a=t?o(e.videoFrameHandler,t):e.videoFrameHandler;i?yield Co(r,a,u,t):yield yo(r,a,u,t)}))),!1),qn(oe(Oo,"videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(c=Te.supports.video)||void 0===c?void 0:c.sharedFrame))throw E;un(oe(Oo,"videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",(n=>{if(n){null==t||t.reportStartFrameProcessing(n.width,n.height);const o=r(),a=n.timestamp;e.videoBufferHandler(i(n),(()=>{o(),null==t||t.reportFrameProcessed(),s(a)}),u)}}),!1),qn(oe(Oo,"videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}null==t||t.startMonitorSlowFrameProcessing()}},e.notifySelectedVideoEffectChanged=function(e,t,n){if(ze(Te,h.sidePanel),!a())throw E;qn(oe(Oo,"videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,n])},e.registerForVideoEffect=function(e){if(ze(Te,h.sidePanel),!a())throw E;un(oe(Oo,"videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",Ro(e,t),!1),qn(oe(Oo,"videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")},e.updatePersonalizedEffects=function(e){if(ze(Te,h.sidePanel),!mo.isSupported())throw E;qn(oe(Oo,"videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])},e.isSupported=a,e.notifyFatalError=function(e){if(ze(Te),!mo.isSupported())throw E;u(e,n.Fatal)}}(ko||(ko={}));const Mo="v2";var Lo;function Uo(e){const t=!e||e.length<=0,n=null==e?void 0:e.indexOf("@"),r=null==e?void 0:e.indexOf(".",n);if(t||-1===n||-1===r)throw new Error("Input email address does not have the correct format.")}!function(e){let t,n;!function(e){e.edu="EDU"}(t=e.AppTypes||(e.AppTypes={})),function(t){function n(){var t;return!!(ze(Te)&&e.isSupported()&&(null===(t=Te.supports.hostEntity)||void 0===t?void 0:t.tab))}function r(e){if(!e||0==e.length)throw new Error(`Error code: ${i.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`)}function o(e){if(!(null==e?void 0:e.internalTabInstanceId)||0===e.internalTabInstanceId.length)throw new Error(`Error code: ${i.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`)}t.addAndConfigure=function(e,t){if(ze(Te),!n())throw new Error(`Error code: ${i.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);if(r(e.threadId),t&&0===t.length)throw new Error(`Error code: ${i.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);return Vn(oe(Mo,"hostEntity.tab.addAndConfigure"),"hostEntity.tab.addAndConfigure",[e,t]).then((([e])=>{var t;if(C(e))throw new Error(`Error code: ${e.errorCode}, message: ${null!==(t=e.message)&&void 0!==t?t:"None"}`);return e}))},t.getAll=function(e){if(ze(Te),!n())throw new Error(`Error code: ${i.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return r(e.threadId),Vn(oe(Mo,"hostEntity.tab.getAll"),"hostEntity.tab.getAll",[e]).then((([e])=>{var t;if(C(e))throw new Error(`Error code: ${e.errorCode}, message: ${null!==(t=e.message)&&void 0!==t?t:"None"}`);return e}))},t.reconfigure=function(e,t){if(ze(Te),!n())throw new Error(`Error code: ${i.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return o(e),r(t.threadId),Vn(oe(Mo,"hostEntity.tab.reconfigure"),"hostEntity.tab.reconfigure",[e,t]).then((([e])=>{var t;if(C(e))throw new Error(`Error code: ${e.errorCode}, message: ${null!==(t=e.message)&&void 0!==t?t:"None"}`);return e}))},t.rename=function(e,t){if(ze(Te),!n())throw new Error(`Error code: ${i.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return o(e),r(t.threadId),Vn(oe(Mo,"hostEntity.tab.rename"),"hostEntity.tab.rename",[e,t]).then((([e])=>{var t;if(C(e))throw new Error(`Error code: ${e.errorCode}, message: ${null!==(t=e.message)&&void 0!==t?t:"None"}`);return e}))},t.remove=function(e,t){if(ze(Te),!n())throw new Error(`Error code: ${i.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return r(t.threadId),o(e),Vn(oe(Mo,"hostEntity.tab.remove"),"hostEntity.tab.remove",[e,t]).then((([e])=>{var t;if(C(e))throw new Error(`Error code: ${e.errorCode}, message: ${null!==(t=e.message)&&void 0!==t?t:"None"}`);return!0}))},t.isSupported=n}(n=e.tab||(e.tab={})),e.isSupported=function(){return!(!ze(Te)||!Te.supports.hostEntity)}}(Lo||(Lo={}));class No{constructor(e){this.val=e,Uo(e)}toString(){return this.val}}const xo="users";function Do(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");const r=`${xo}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&topicName=${encodeURIComponent(t)}`,i=void 0===n?"":`&message=${encodeURIComponent(n)}`;return`${he}://${ge}/l/chat/0/0?${r}${o}${i}`}function Ho(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");const r=`${xo}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&withVideo=${encodeURIComponent(t)}`,i=void 0===n?"":`&source=${encodeURIComponent(n)}`;return`${he}://${ge}/l/call/0/0?${r}${o}${i}`}function _o(e,t,n,r,o){const i=void 0===e?"":"attendees="+e.map((e=>encodeURIComponent(e))).join(","),a=void 0===t?"":`&startTime=${encodeURIComponent(t)}`,s=void 0===n?"":`&endTime=${encodeURIComponent(n)}`,u=void 0===r?"":`&subject=${encodeURIComponent(r)}`,c=void 0===o?"":`&content=${encodeURIComponent(o)}`;return`${he}://${ge}/l/meeting/new?${i}${a}${s}${u}${c}`}function Bo(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return`${he}://${ge}/l/app/${encodeURIComponent(e)}`}var Vo;!function(e){function t(){return!(!ze(Te)||!Te.supports.appInstallDialog)}e.openAppInstallDialog=function(e){return new Promise((n=>{if(ze(Te,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!t())throw new Error("Not supported");const r=oe("v1","appInstallDialog.openAppInstallDialog");Te.isLegacyTeams?n(Hn(r,"executeDeepLink",Bo(e.appId))):(qn(r,"appInstallDialog.openAppInstallDialog",[e]),n())}))},e.isSupported=t}(Vo||(Vo={}));const Wo="v1",jo=re("media");var zo;function qo(e,t){if(null==e||null==t||e.length<=0)return null;let n=null,r=1;return e.sort(((e,t)=>e.sequence>t.sequence?1:-1)),e.forEach((e=>{e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n}function $o(e,t){if(null==e||null==t)return null;const n=atob(e.chunk),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);const o=new Uint8Array(r),i=new Blob([o],{type:t});return{sequence:e.chunkSequence,file:i}}function Go(e){Qo(e)?Ge("2.0.2"):Xo(e)?Ge(ue):Zo(e)&&Ge("2.0.4")}function Jo(e){return!(e.mediaType!=zo.MediaType.Video||!e.videoProps||!e.videoProps.videoController)}function Ko(e){return!(null==e||e.maxMediaCount>10)}function Zo(e){var t;return!((null==e?void 0:e.mediaType)!=zo.MediaType.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}function Qo(e){return!(!e||e.mediaType!=zo.MediaType.VideoAndImage&&!e.videoAndImageProps)}function Xo(e){return!(!e||e.mediaType!=zo.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function Yo(e,t,n){return null!=e&&null!=t&&t==zo.FileFormat.ID&&null!=n}function ei(e){return!(null==e||e.length<=0||e.length>10)}function ti(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function ni(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}!function(e){let t,n,r,o,s,u,c;!function(e){e.Base64="base64",e.ID="id"}(t=e.FileFormat||(e.FileFormat={}));class l{}function d(){return!(!ze(Te)||!Te.supports.permissions)}e.File=l,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");if(ze(Te,h.content,h.task),ye.isFramelessWindow)if(qe("1.7.0"))qn(oe(Wo,"media.captureImage"),"captureImage",e);else{e({errorCode:i.OLD_PLATFORM},[])}else{e({errorCode:i.NOT_SUPPORTED_ON_PLATFORM},[])}},e.hasPermission=function(){if(ze(Te,h.content,h.task),!d())throw E;const e=a.Media;return new Promise((t=>{t(Bn(oe(Wo,"media.hasPermission"),"permissions.has",e))}))},e.requestPermission=function(){if(ze(Te,h.content,h.task),!d())throw E;const e=a.Media;return new Promise((t=>{t(Bn(oe(Wo,"media.requestPermission"),"permissions.request",e))}))};class p extends l{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){if(!e)throw new Error("[get Media] Callback cannot be null");if(ze(Te,h.content,h.task),qe(le))if(Yo(this.mimeType,this.format,this.content))qe("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e);else{e({errorCode:i.INVALID_ARGUMENTS},new Blob)}else{e({errorCode:i.OLD_PLATFORM},new Blob)}}getMediaViaCallback(e){const t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];qn(oe(Wo,"media.getMedia"),"getMedia",n,(function(n){if(e)if(n&&n.error)e(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){const r=qo(t.assembleAttachment,t.mediaMimeType);e(n.error,null!=r?r:new Blob)}else{const e=$o(n.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):jo(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else e({errorCode:i.INTERNAL_ERROR,message:"data received is null"},new Blob)}))}getMediaViaHandler(e){const t=L(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&!Ke(e)&&qn(oe(Wo,"media.getMedia"),"getMedia",r),un(oe(Wo,"media.registerGetMediaRequestHandler"),"getMedia"+t,(function(r){if(e){const o=JSON.parse(r);if(o.error)e(o.error,new Blob),cn("getMedia"+t);else if(o.mediaChunk)if(o.mediaChunk.chunkSequence<=0){const r=qo(n.assembleAttachment,n.mediaMimeType);e(o.error,null!=r?r:new Blob),cn("getMedia"+t)}else{const e=$o(o.mediaChunk,n.mediaMimeType);e&&n.assembleAttachment.push(e)}else e({errorCode:i.INTERNAL_ERROR,message:"data received is null"},new Blob),cn("getMedia"+t)}}))}}e.Media=p;class g{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){ze(Te,h.content,h.task);try{Ge(ue)}catch(e){return void(t&&t(e))}const n={mediaType:this.getMediaType(),mediaControllerEvent:e};qn(oe(Wo,"media.controller"),"media.controller",[n],(e=>{t&&t(e)}))}stop(e){this.notifyEventToHost(n.StopRecording,e)}}e.VideoController=class extends g{getMediaType(){return s.Video}notifyEventToApp(e){if(this.controllerCallback)switch(e){case n.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}}},function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(n=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(r=e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(o=e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(s=e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(u=e.ImageUriType||(e.ImageUriType={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(c=e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(ze(Te,h.content,h.task),!qe(le)){const e={errorCode:i.OLD_PLATFORM};return void t(e,[])}try{Go(e)}catch(e){return void t(e,[])}if(!Ko(e)){const e={errorCode:i.INVALID_ARGUMENTS};return void t(e,[])}const n=[e];qn(oe(Wo,"media.selectMedia"),"selectMedia",n,((n,r,o)=>{var i,a;if(o)return void(Jo(e)&&(null===(a=null===(i=null==e?void 0:e.videoProps)||void 0===i?void 0:i.videoController)||void 0===a||a.notifyEventToApp(o)));if(!r)return void t(n,[]);const s=[];for(const e of r)s.push(new p(e));t(n,s)}))},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");if(ze(Te,h.content,h.task),!qe(le)){return void t({errorCode:i.OLD_PLATFORM})}if(!ei(e)){return void t({errorCode:i.INVALID_ARGUMENTS})}const n=[e];qn(oe(Wo,"media.viewImages"),"viewImages",n,t)},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");if(ze(Te,h.content,h.task),ye.hostClientType!==f.desktop&&ye.hostClientType!==f.web&&ye.hostClientType!==f.rigel&&ye.hostClientType!==f.teamsRoomsWindows&&ye.hostClientType!==f.teamsRoomsAndroid&&ye.hostClientType!==f.teamsPhones&&ye.hostClientType!==f.teamsDisplays)if(qe("1.9.0"))if(ti(t))qn(oe(Wo,"media.scanBarCode"),"media.scanBarCode",[t],e);else{e({errorCode:i.INVALID_ARGUMENTS},"")}else{e({errorCode:i.OLD_PLATFORM},"")}else{e({errorCode:i.NOT_SUPPORTED_ON_PLATFORM},"")}}}(zo||(zo={}));const ri="v2";var oi;!function(e){function t(){return!!(ze(Te)&&Te.supports.barCode&&Te.supports.permissions)}e.scanBarCode=function(e){return new Promise((n=>{if(ze(Te,h.content,h.task),!t())throw E;if(!ti(e))throw{errorCode:i.INVALID_ARGUMENTS};n(Bn(oe(ri,"barCode.scanBarCode"),"media.scanBarCode",e))}))},e.hasPermission=function(){if(ze(Te,h.content,h.task),!t())throw E;const e=a.Media;return new Promise((t=>{t(Bn(oe(ri,"barCode.hasPermission"),"permissions.has",e))}))},e.requestPermission=function(){if(ze(Te,h.content,h.task),!t())throw E;const e=a.Media;return new Promise((t=>{t(Bn(oe(ri,"barCode.requestPermission"),"permissions.request",e))}))},e.isSupported=t}(oi||(oi={}));var ii;!function(e){function t(e,t){return new Promise((r=>{if(ze(Te,h.content,h.task),!n())throw E;if(Te.isLegacyTeams)r(Hn(e,"executeDeepLink",Do([t.user],void 0,t.message)));else{r(Hn(e,"chat.openChat",{members:[t.user],message:t.message}))}}))}function n(){return!(!ze(Te)||!Te.supports.chat)}e.openChat=function(e){return t(oe("v2","chat.openChat"),e)},e.openGroupChat=function(e){const r=oe("v2","chat.openGroupChat");return new Promise((o=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){const n={user:e.users[0],message:e.message};o(t(r,n))}else{if(ze(Te,h.content,h.task),!n())throw E;if(Te.isLegacyTeams)o(Hn(r,"executeDeepLink",Do(e.users,e.topic,e.message)));else{o(Hn(r,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}}))},e.isSupported=n}(ii||(ii={}));var ai=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};var si,ui;!function(e){function t(){return ye.isFramelessWindow?!(!ze(Te)||!Te.supports.clipboard):!!(ze(Te)&&navigator&&navigator.clipboard&&Te.supports.clipboard)}e.write=function(e){return ai(this,void 0,void 0,(function*(){if(ze(Te,h.content,h.meetingStage,h.task,h.settings,h.stage,h.sidePanel),!t())throw E;if(!e.type||!Object.values(d).includes(e.type))throw new Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(d)}`);const n=yield j(e),r={mimeType:e.type,content:n};return Bn(oe("v2","clipboard.write"),"clipboard.writeToClipboard",r)}))},e.read=function(){return ai(this,void 0,void 0,(function*(){ze(Te,h.content,h.meetingStage,h.task,h.settings,h.stage,h.sidePanel);const e=oe("v2","clipboard.read");if(!t())throw E;const n=yield Bn(e,"clipboard.readFromClipboard");if("string"==typeof n){const e=JSON.parse(n);return W(e.mimeType,e.content)}return n}))},e.isSupported=t}(si||(si={})),function(e){e.isNAAChannelRecommended=function(){var e;return null!==(e=ze(Te)&&Te.isNAAChannelRecommended)&&void 0!==e&&e}}(ui||(ui={}));const ci="v2";var li;function di(){return Te.hostVersionsInfo?Te.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(e){function t(){return!!(ze(Te)&&Te.supports.geoLocation&&Te.supports.permissions)}let n;e.getCurrentLocation=function(){if(ze(Te,h.content,h.task),!t())throw E;return Bn(oe(ci,"geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(ze(Te,h.content,h.task),!t())throw E;const e=a.GeoLocation;return new Promise((t=>{t(Bn(oe(ci,"geoLocation.hasPermission"),"permissions.has",e))}))},e.requestPermission=function(){if(ze(Te,h.content,h.task),!t())throw E;const e=a.GeoLocation;return new Promise((t=>{t(Bn(oe(ci,"geoLocation.requestPermission"),"permissions.request",e))}))},e.isSupported=t,function(e){function t(){return!!(ze(Te)&&Te.supports.geoLocation&&Te.supports.geoLocation.map&&Te.supports.permissions)}e.chooseLocation=function(){if(ze(Te,h.content,h.task),!t())throw E;return Bn(oe(ci,"geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},e.showLocation=function(e){if(ze(Te,h.content,h.task),!t())throw E;if(!e)throw{errorCode:i.INVALID_ARGUMENTS};return Bn(oe(ci,"geoLocation.showLocation"),"location.showLocation",e)},e.isSupported=t}(n=e.map||(e.map={}))}(li||(li={}));const fi="v1";class pi{postMessage(e,t){ze(Te),qn(oe(fi,"appWindow.childAppWindow.postMessage"),"messageForChild",[e],t||k())}addEventListener(e,t){ze(Te),"message"===e&&un(oe(fi,"appWindow.childAppWindow.addEventListener"),"messageForParent",t)}}class hi{static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){ze(Te,h.task),qn(oe(fi,"appWindow.parentAppWindow.postMessage"),"messageForParent",[e],t||k())}addEventListener(e,t){ze(Te,h.task),"message"===e&&un(oe(fi,"appWindow.parentAppWindow.addEventListener"),"messageForChild",t)}}var gi;!function(e){function t(){return!(!ze(Te)||!Te.supports.secondaryBrowser)}e.open=function(e){if(ze(Te,h.content),!t())throw E;if(!e||!V(e))throw{errorCode:i.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return Bn(oe("v2","secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())},e.isSupported=t}(gi||(gi={}));var mi;!function(e){function t(){return!(!ze(Te)||!Te.supports.location)}e.getLocation=function(e,n){if(!n)throw new Error("[location.getLocation] Callback cannot be null");if(ze(Te,h.content,h.task),!qe(ce))throw{errorCode:i.OLD_PLATFORM};if(!e)throw{errorCode:i.INVALID_ARGUMENTS};if(!t())throw E;qn(oe("v1","location.getLocation"),"location.getLocation",[e],n)},e.showLocation=function(e,n){if(!n)throw new Error("[location.showLocation] Callback cannot be null");if(ze(Te,h.content,h.task),!qe(ce))throw{errorCode:i.OLD_PLATFORM};if(!e)throw{errorCode:i.INVALID_ARGUMENTS};if(!t())throw E;qn(oe("v1","location.showLocation"),"location.showLocation",[e],n)},e.isSupported=t}(mi||(mi={}));var wi=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const vi="v1";var yi;!function(e){let t,n,r,o,a,s,u;function c(e,n){qn(oe(vi,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((r,o)=>{if(r&&null!=o)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(r)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${r.errorCode} ${r.message}`);if("boolean"!=typeof o)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");un(oe(vi,"meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",(n=>wi(this,void 0,void 0,(function*(){try{const r=yield e.micMuteStateChangedCallback(n);d(r,r.isMicMuted===n.isMicMuted?t.HostInitiated:t.AppDeclinedToChange)}catch(e){d(n,t.AppFailedToChange)}}))));un(oe(vi,"meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",(t=>{var n;null===(n=e.audioDeviceSelectionChangedCallback)||void 0===n||n.call(e,t)})),n(o)}))}function l(e,t){qn(oe(vi,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((e,n)=>{if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");ln("meeting.micStateChanged")&&cn("meeting.micStateChanged"),ln("meeting.audioDeviceSelectionChanged")&&cn("meeting.audioDeviceSelectionChanged"),t(n)}))}function d(e,t){ze(Te,h.sidePanel,h.meetingStage),qn(oe(vi,"meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(t||(t={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(n=e.MeetingReactionType||(e.MeetingReactionType={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(r=e.MeetingType||(e.MeetingType={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(o=e.CallType||(e.CallType={})),function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"}(a=e.SharingProtocol||(e.SharingProtocol={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage),qn(oe(vi,"meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage),qn(oe(vi,"meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage,h.settings,h.content),qn(oe(vi,"meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)},e.getMeetingDetailsVerbose=function(){var e,t,n;return wi(this,void 0,void 0,(function*(){let r;ze(Te,h.sidePanel,h.meetingStage,h.settings,h.content);try{const e=!0;r=yield Bn(oe("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",e)}catch(t){throw new Error(null===(e=null==t?void 0:t.errorCode)||void 0===e?void 0:e.toString())}if(((null===(t=r.details)||void 0===t?void 0:t.type)==o.GroupCall||(null===(n=r.details)||void 0===n?void 0:n.type)==o.OneOnOneCall)&&!r.details.originalCallerInfo)throw new Error(i.NOT_SUPPORTED_ON_PLATFORM.toString());return r}))},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage,h.task),qn(oe(vi,"meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");ze(Te,h.sidePanel),qn(oe(vi,"meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");ze(Te,h.sidePanel),qn(oe(vi,"meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");ze(Te,h.sidePanel),qn(oe(vi,"meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");ze(Te,h.sidePanel),un(oe(vi,"meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t,n={sharingProtocol:a.Collaborative}){if(!e)throw new Error("[share app content to stage] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage),qn(oe(vi,"meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,n],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage),qn(oe(vi,"meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage),qn(oe(vi,"meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");ze(Te,h.sidePanel,h.meetingStage),qn(oe(vi,"meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");ze(Te,h.sidePanel,h.meetingStage),un(oe(vi,"meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)},e.registerRaiseHandStateChangedHandler=function(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");ze(Te,h.sidePanel,h.meetingStage),un(oe(vi,"meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)},e.registerMeetingReactionReceivedHandler=function(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");ze(Te,h.sidePanel,h.meetingStage),un(oe(vi,"meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)},e.joinMeeting=function(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(new Error("Invalid joinMeetingParams"));ze(Te);const t={joinWebUrl:e.joinWebUrl.href,source:e.source||s.Other};return Bn(oe("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)},function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"}(s=e.EventActionSource||(e.EventActionSource={})),function(e){e.setOptions=function(e){ze(Te,h.sidePanel),e.contentUrl&&new URL(e.contentUrl),qn(oe(vi,"meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}}(u=e.appShareButton||(e.appShareButton={})),e.requestAppAudioHandling=function(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");ze(Te,h.sidePanel,h.meetingStage),e.isAppHandlingAudio?c(e,t):l(e,t)},e.updateMicState=function(e){d(e,t.AppInitiated)}}(yi||(yi={}));var Ci;!function(e){function t(){return!(!ze(Te)||!Te.supports.monetization)}e.openPurchaseExperience=function(e,n){let r,o,i="";return"function"==typeof e?(r=e,o=n,i=oe("v1","monetization.openPurchaseExperience")):(o=e,i=oe("v2","monetization.openPurchaseExperience")),ze(Te,h.content),D((()=>new Promise((e=>{if(!t())throw E;e(Bn(i,"monetization.openPurchaseExperience",o))}))),r)},e.isSupported=t}(Ci||(Ci={}));var bi;!function(e){function t(){return!(!ze(Te)||!Te.supports.calendar)}e.openCalendarItem=function(e){return new Promise((n=>{if(ze(Te,h.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");n(Hn(oe("v2","calendar.openCalendarItem"),"calendar.openCalendarItem",e))}))},e.composeMeeting=function(e){return new Promise((n=>{if(ze(Te,h.content),!t())throw new Error("Not supported");const r=oe("v2","calendar.composeMeeting");Te.isLegacyTeams?n(Hn(r,"executeDeepLink",_o(e.attendees,e.startTime,e.endTime,e.subject,e.content))):n(Hn(r,"calendar.composeMeeting",e))}))},e.isSupported=t}(bi||(bi={}));var Si;!function(e){function t(){return!(!ze(Te)||!Te.supports.mail)}let n;e.openMailItem=function(e){return new Promise((n=>{if(ze(Te,h.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");n(Hn(oe("v2","mail.openMailItem"),"mail.openMailItem",e))}))},e.composeMail=function(e){return new Promise((n=>{if(ze(Te,h.content),!t())throw new Error("Not supported");n(Hn(oe("v2","mail.composeMail"),"mail.composeMail",e))}))},e.isSupported=t,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(n=e.ComposeMailType||(e.ComposeMailType={}))}(Si||(Si={}));var Ei;!function(e){function t(){z().print()}function n(e,t,n){!Ke(t)&&ze(Te),!Ke(t)&&n&&n(),hn(e,t)}function r(e,t,n){!Ke(t)&&ze(Te),!Ke(t)&&n&&n(),wn(e,t)}function o(){return!(!ze(Te)||!Te.supports.teamsCore)}e.enablePrintCapability=function(){if(!ye.printCapabilityEnabled){if(ze(Te),!o())throw E;ye.printCapabilityEnabled=!0,document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}},e.print=t,e.registerOnLoadHandler=function(e){n(oe("v2","teamsAPIs_registerOnLoadHandler"),e,(()=>{if(!Ke(e)&&!o())throw E}))},e.registerOnLoadHandlerHelper=n,e.registerBeforeUnloadHandler=function(e){r(oe("v2","teamsAPIs_registerBeforeUnloadHandler"),e,(()=>{if(!Ke(e)&&!o())throw E}))},e.registerBeforeUnloadHandlerHelper=r,e.isSupported=o}(Ei||(Ei={}));var Ai;function Ii(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?Ti(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function Ti(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}!function(e){function t(e,t){return new Promise((r=>{if(!qe("2.0.0"))throw{errorCode:i.OLD_PLATFORM};if(!ni(t))throw{errorCode:i.INVALID_ARGUMENTS};if(!n())throw E;r(Bn(e,"people.selectPeople",t))}))}function n(){return!(!ze(Te)||!Te.supports.people)}e.selectPeople=function(e,n){let r,o;ze(Te,h.content,h.task,h.settings);let i="";return"function"==typeof e?([r,o]=[e,n],i=oe("v1","people.selectPeople")):(o=e,i=oe("v2","people.selectPeople")),N(t,r,i,o)},e.isSupported=n}(Ai||(Ai={}));var Pi;!function(e){e.showProfile=function(e){return ze(Te,h.content),new Promise((t=>{const[n,r]=Ii(e);if(!n)throw{errorCode:i.INVALID_ARGUMENTS,message:r};const o={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(Bn(oe("v2","profile.showProfile"),"profile.showProfile",o))}))},e.isSupported=function(){return!(!ze(Te)||!Te.supports.profile)}}(Pi||(Pi={}));const Ri="v2";var Fi;!function(e){const t="search.queryChange",n="search.queryClose",r="search.queryExecute";function o(){return!(!ze(Te)||!Te.supports.search)}e.registerHandlers=function(e,i,a){if(ze(Te,h.content),!o())throw E;un(oe(Ri,"search.registerOnClosedHandler"),n,e),un(oe(Ri,"search.registerOnExecutedHandler"),r,i),a&&un(oe(Ri,"search.registerOnChangeHandler"),t,a)},e.unregisterHandlers=function(){if(ze(Te,h.content),!o())throw E;qn(oe(Ri,"search.unregisterHandlers"),"search.unregister"),cn(t),cn(n),cn(r)},e.isSupported=o,e.closeSearch=function(){return new Promise((e=>{if(ze(Te,h.content),!o())throw new Error("Not supported");e(Hn(oe(Ri,"search.closeSearch"),"search.closeSearch"))}))}}(Fi||(Fi={}));var Oi=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};var ki;!function(e){function t(t,n){return new Promise((r=>{if(!a())throw E;r(Bn(t,e.SharingAPIMessages.shareWebContent,n))}))}function n(e){if(!(e&&e.content&&e.content.length)){throw{errorCode:i.INVALID_ARGUMENTS,message:"Shared content is missing"}}}function r(e){let t;if(e.content.some((e=>!e.type)))throw t={errorCode:i.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"},t;if(e.content.some((t=>t.type!==e.content[0].type)))throw t={errorCode:i.INVALID_ARGUMENTS,message:"Shared content must be of the same type"},t}function o(e){let t;if("URL"!==e.content[0].type)throw t={errorCode:i.INVALID_ARGUMENTS,message:"Content type is unsupported"},t;if(e.content.some((e=>!e.url)))throw t={errorCode:i.INVALID_ARGUMENTS,message:"URLs are required for URL content types"},t}function a(){return!(!ze(Te)||!Te.supports.sharing)}let s;e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(e,i){try{n(e),r(e),o(e)}catch(e){return x((()=>Promise.reject(e)),i)}return ze(Te,h.content,h.sidePanel,h.task,h.stage,h.meetingStage),x(t,i,oe(i?"v1":"v2","sharing.shareWebContent"),e)},e.isSupported=a,function(e){function t(){var e;return ze(Te)&&void 0!==(null===(e=Te.supports.sharing)||void 0===e?void 0:e.history)}e.getContent=function(){return Oi(this,void 0,void 0,(function*(){if(ze(Te,h.sidePanel,h.meetingStage),!t())throw E;return yield Bn(oe("v2","sharing.history.getContent"),"sharing.history.getContent")}))},e.isSupported=t}(s=e.history||(e.history={}))}(ki||(ki={}));var Mi;!function(e){let t,n;function r(){return!(!ze(Te)||!Te.supports.stageView)}!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(t=e.StageViewOpenMode||(e.StageViewOpenMode={})),e.open=function(e){return new Promise((t=>{if(ze(Te,h.content),!r())throw E;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(Bn(oe("v2","stageView.open"),"stageView.open",e))}))},e.isSupported=r,function(e){function t(){var e;return ze(Te)&&void 0!==(null===(e=Te.supports.stageView)||void 0===e?void 0:e.self)}e.close=function(){return new Promise((e=>{if(ze(Te,h.content),!t())throw E;e(Bn(oe("v2","stageView.self.close"),"stageView.self.close"))}))},e.isSupported=t}(n=e.self||(e.self={}))}(Mi||(Mi={}));var Li=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const Ui="v2";var Ni;!function(e){let t,n,r;!function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(t=e.CameraRestriction||(e.CameraRestriction={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(n=e.Source||(e.Source={})),e.hasPermission=function(){if(ze(Te,h.content,h.task),!r.isSupported())throw E;const e=a.Media;return Bn(oe(Ui,"visualMedia.hasPermission"),"permissions.has",e)},e.requestPermission=function(){if(ze(Te,h.content,h.task),!r.isSupported())throw E;const e=a.Media;return Bn(oe(Ui,"visualMedia.requestPermission"),"permissions.request",e)},function(e){function t(){return!!(ze(Te)&&Te.supports.visualMedia&&Te.supports.visualMedia.image&&Te.supports.permissions)}function n(){if(!t())throw E}function r(e){if(!e||e.maxVisualMediaCount>10||e.maxVisualMediaCount<1)throw P}function o(e,t){if(t.length>e)throw R}e.captureImages=function(e){return Li(this,void 0,void 0,(function*(){ze(Te,h.content,h.task),n(),r(e);const t=yield Bn(oe(Ui,"visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return o(e.maxVisualMediaCount,t),t}))},e.retrieveImages=function(e){return Li(this,void 0,void 0,(function*(){ze(Te,h.content,h.task),n(),r(e);const t=yield Bn(oe(Ui,"visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return o(e.maxVisualMediaCount,t),t}))},e.isSupported=t}(r=e.image||(e.image={}))}(Ni||(Ni={}));var xi,Di=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))};!function(e){function t(){return Di(this,void 0,void 0,(function*(){return null===Hi&&(Hi=(yield xt.getContext()).app.host.name),Hi}))}function n(){return ze(Te)&&void 0!==Te.supports.webStorage}e.isWebStorageClearedOnUserLogOut=function(){return Di(this,void 0,void 0,(function*(){if(ze(Te),!n())throw E;return!(!Te.isLegacyTeams||ye.hostClientType!==f.android&&ye.hostClientType!==f.ios&&ye.hostClientType!==f.ipados||(yield t())!==p.teams)||(yield Dn(oe("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut"))}))},e.isSupported=n}(xi||(xi={}));let Hi=null;var _i;!function(e){let t;function n(){return!(!ze(Te)||!Te.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(t=e.CallModalities||(e.CallModalities={})),e.startCall=function(e){const r=oe("v2","call.startCall");return new Promise((o=>{var i;if(ze(Te,h.content,h.task),!n())throw E;if(!Te.isLegacyTeams)return qn(r,"call.startCall",[e],o);o(Dn(r,"executeDeepLink",Ho(e.targets,null===(i=e.requestedModalities)||void 0===i?void 0:i.includes(t.Video),e.source)).then((e=>{if(!e)throw new Error("The call was not properly started");return e})))}))},e.isSupported=n}(_i||(_i={}));const Bi="v1";var Vi;!function(e){e.Messages=xt.Messages,e.FailedReason=xt.FailedReason,e.ExpectedFailureReason=xt.ExpectedFailureReason,e.notifyAppLoaded=function(){Rt(oe(Bi,"appInitialization.notifyAppLoaded"))},e.notifySuccess=function(){kt(oe(Bi,"appInitialization.notifySuccess"))},e.notifyFailure=function(e){Ot(oe(Bi,"appInitialization.notifyFailure"),e)},e.notifyExpectedFailure=function(e){Ft(oe(Bi,"appInitialization.notifyExpectedFailure"),e)}}(Vi||(Vi={}));const Wi=re("thirdPartyCloudStorage");var ji;!function(e){class t{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let n=[],r=null,o=!0,a=null;function s(e){if(a)if(e&&e.error)a([],e.error),a=null;else if(e&&e.fileChunk)try{o||0!==e.fileChunk.chunkSequence||(Wi("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),o=!0,a([],{errorCode:i.INTERNAL_ERROR,message:"error occurred while receiving data"}),n=[],a=null);const s=$o(e.fileChunk,e.fileType);if(s?(r||(r=new t(e.fileType,[])),r.assembleAttachment.push(s)):(Wi(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),a?a([],{errorCode:i.INTERNAL_ERROR,message:"error occurred while receiving data"}):a=null,n=[],a=null,o=!0),o=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&r){const t=qo(r.assembleAttachment,r.fileType);if(t){const r=new File([t],e.fileName,{type:t.type});n.push(r)}e.isLastFile&&a&&(a(n,e.error),n=[],a=null,o=!0),r=null}}catch(e){a&&(a([],{errorCode:i.INTERNAL_ERROR,message:e}),n=[],a=null,o=!0)}else a([],{errorCode:i.INTERNAL_ERROR,message:"data received is null"}),n=[],a=null,o=!0}function u(){return!(!ze(Te)||!Te.supports.thirdPartyCloudStorage)}e.getDragAndDropFiles=function(e,t){if(!t)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if(ze(Te,h.content,h.task),!u())throw E;if(a)throw a=null,new Error("getDragAndDropFiles cannot be called twice");a=t,o=!0,qn(oe("v2","thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],s)}else{t([],{errorCode:i.INVALID_ARGUMENTS})}},e.isSupported=u}(ji||(ji={}));const zi="v1";function qi(e,t){Pt(oe(zi,"initialize"),t).then((()=>{e&&e()}))}function $i(){Ei.enablePrintCapability()}function Gi(){Ei.print()}function Ji(e){je(),qn(oe(zi,"getContext"),"getContext",(t=>{t.frameContext||(t.frameContext=ye.frameContext),e(t)}))}function Ki(e){Ut(oe(zi,"registerOnThemeChangeHandlerHelper"),e)}function Zi(e){dn(oe(zi,"registerFullScreenHandler"),"fullScreenChange",e,[])}function Qi(e){dn(oe(zi,"registerAppButtonClickHandler"),"appButtonClick",e,[h.content])}function Xi(e){dn(oe(zi,"registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[h.content])}function Yi(e){dn(oe(zi,"registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[h.content])}function ea(e){Zt.backStack.registerBackButtonHandlerHelper(oe(zi,"registerBackButtonHandler"),e)}function ta(e){Ei.registerOnLoadHandlerHelper(oe(zi,"registerOnLoadHandler"),e)}function na(e){Ei.registerBeforeUnloadHandlerHelper(oe(zi,"registerBeforeUnloadHandler"),e)}function ra(e){dn(oe(zi,"registerFocusEnterHandler"),"focusEnter",e,[])}function oa(e){dn(oe(zi,"registerChangeSettingsHandler"),"changeSettings",e,[h.content])}function ia(e,t){ze(Te),jt(oe(zi,"getTabInstances"),t).then((t=>{e(t)}))}function aa(e,t){ze(Te),zt(oe(zi,"getMruTabInstances"),t).then((t=>{e(t)}))}function sa(e){qt(oe(zi,"shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function ua(e,t){ze(Te,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage);const n=null!=t?t:k();Nt(oe(zi,"executeDeepLink"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function ca(e){$t(oe(zi,"setFrameContext"),e)}function la(e,t,n){Pt(oe(zi,"initializeWithFrameContext"),n).then((()=>t&&t())),$t(oe(zi,"setFrameContext"),e)}const da="v1";function fa(e){Wt(oe(da,"navigation.returnFocus"),e)}function pa(e,t){ze(Te);const n=null!=t?t:k();Vt(oe(da,"navigation.navigateToTab"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function ha(e,t){ze(Te,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage);const n=null!=t?t:k();_t(oe(da,"navigation.navigateCrossDomain"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function ga(e){ze(Te);const t=null!=e?e:k();Bt(oe(da,"navigation.navigateBack")).then((()=>{t(!0)})).catch((e=>{t(!1,e.message)}))}const ma="v1";var wa;!function(e){e.setValidityState=function(e){Gt(oe(ma,"settings.setValidityState"),e)},e.getSettings=function(e){ze(Te,h.content,h.settings,h.remove,h.sidePanel),Jt(oe(ma,"settings.getSettings")).then((t=>{e(t)}))},e.setSettings=function(e,t){ze(Te,h.content,h.settings,h.sidePanel);const n=null!=t?t:k();Kt(oe(ma,"settings.setSettings"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))},e.registerOnSaveHandler=function(e){Zt.config.registerOnSaveHandlerHelper(oe(ma,"settings.registerOnSaveHandler"),e)},e.registerOnRemoveHandler=function(e){Zt.config.registerOnRemoveHandlerHelper(oe(ma,"settings.registerOnRemoveHandler"),e)}}(wa||(wa={}));var va=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const ya="v1";var Ca;!function(e){function t(e){if(void 0===e.url)throw new Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:S.Small,width:e.width?e.width:S.Small},title:e.title,fallbackUrl:e.fallbackUrl}}function n(e){if(void 0===e.url||void 0===e.completionBotId)throw new Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:S.Small,width:e.width?e.width:S.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function r(e){return e.height=e.height?e.height:S.Small,e.width=e.width?e.width:S.Small,e}e.startTask=function(e,r){const o=oe(ya,"tasks.startTask"),i=r?e=>{var t,n;return r(null!==(t=e.err)&&void 0!==t?t:"",null!==(n=e.result)&&void 0!==n?n:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(ze(Te,h.content,h.sidePanel,h.meetingStage),qn(o,"tasks.startTask",[e],r)):void 0!==e.completionBotId?yt(o,n(e),i):vt(o,t(e),i),new pi},e.updateTask=function(e){e=r(e);const{width:t,height:n}=e,o=va(e,["width","height"]);if(Object.keys(o).length)throw new Error("resize requires a TaskInfo argument containing only width and height");wt(oe(ya,"tasks.updateTask"),e)},e.submitTask=function(e,t){Ct(oe(ya,"tasks.submitTask"),e,t)},e.getDefaultSizeIfNotProvided=r}(Ca||(Ca={}));const ba="v2";var Sa;!function(e){let t,n;!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(t=e.UserMeetingRole||(e.UserMeetingRole={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(n=e.ContainerState||(e.ContainerState={})),e.isSupported=function(){return!(!ze(Te,h.meetingStage,h.sidePanel,h.content)||!Te.supports.interactive)}}(Sa||(Sa={}));class Ea{getFluidTenantInfo(){return Aa(),new Promise((e=>{e(Bn(oe(ba,"interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))}))}getFluidToken(e){return Aa(),new Promise((t=>{t(Bn(oe(ba,"interactive.getFluidToken"),"interactive.getFluidToken",e))}))}getFluidContainerId(){return Aa(),new Promise((e=>{e(Bn(oe(ba,"interactive.getFluidContainerId"),"interactive.getFluidContainerId"))}))}setFluidContainerId(e){return Aa(),new Promise((t=>{t(Bn(oe(ba,"interactive.setFluidContainerId"),"interactive.setFluidContainerId",e))}))}getNtpTime(){return Aa(),new Promise((e=>{e(Bn(oe(ba,"interactive.getNtpTime"),"interactive.getNtpTime"))}))}registerClientId(e){return Aa(),new Promise((t=>{t(Bn(oe(ba,"interactive.registerClientId"),"interactive.registerClientId",e))}))}getClientRoles(e){return Aa(),new Promise((t=>{t(Bn(oe(ba,"interactive.getClientRoles"),"interactive.getClientRoles",e))}))}getClientInfo(e){return Aa(),new Promise((t=>{t(Bn(oe(ba,"interactive.getClientInfo"),"interactive.getClientInfo",e))}))}static create(){return Aa(),new Ea}}function Aa(){if(!Sa.isSupported())throw new Error("LiveShareHost Not supported")}var Ia=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function Ta(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Pa(e){try{return e.cartItems=Ra(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function Ra(e){return e.map((e=>{if(e.imageURL){const t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=Ra(e.accessories)),e}))}const Fa=e=>{try{return e.map((e=>{const{imageURL:t,accessories:n}=e,r=Ia(e,["imageURL","accessories"]),o=Object.assign({},r);return t&&(o.imageURL=t.href),n&&(o.accessories=Fa(n)),o}))}catch(e){throw new Error("Error serializing cart items")}};function Oa(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(const t of e)Ma(t),ka(t.accessories)}function ka(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(const t of e){if(t.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");Ma(t)}}}function Ma(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");Ua(e.price),Na(e.quantity)}function La(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===Ta(e))throw new Error("id must be a valid UUID")}}function Ua(e){if("number"!=typeof e||e<0)throw new Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw new Error(`price ${e} must have at most 3 decimal places`)}function Na(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error(`quantity ${e} must be an integer greater than 0`)}function xa(e){if(!Object.values(Ha.CartStatus).includes(e))throw new Error(`cartStatus ${e} is not valid`)}const Da="v2";var Ha;!function(e){let t,n;function r(){return!(!ze(Te)||!Te.supports.marketplace)}e.cartVersion={majorVersion:1,minorVersion:1},function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(t=e.Intent||(e.Intent={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(n=e.CartStatus||(e.CartStatus={})),e.getCart=function(){if(ze(Te,h.content,h.task),!r())throw E;return Bn(oe(Da,"marketplace.getCart"),"marketplace.getCart",e.cartVersion).then(Pa)},e.addOrUpdateCartItems=function(t){if(ze(Te,h.content,h.task),!r())throw E;if(!t)throw new Error("addOrUpdateCartItemsParams must be provided");return La(null==t?void 0:t.cartId),Oa(null==t?void 0:t.cartItems),Bn(oe(Da,"marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},t),{cartItems:Fa(t.cartItems),cartVersion:e.cartVersion})).then(Pa)},e.removeCartItems=function(t){if(ze(Te,h.content,h.task),!r())throw E;if(!t)throw new Error("removeCartItemsParams must be provided");if(La(null==t?void 0:t.cartId),!Array.isArray(null==t?void 0:t.cartItemIds)||0===(null==t?void 0:t.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return Bn(oe(Da,"marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},t),{cartVersion:e.cartVersion})).then(Pa)},e.updateCartStatus=function(t){if(ze(Te,h.content,h.task),!r())throw E;if(!t)throw new Error("updateCartStatusParams must be provided");return La(null==t?void 0:t.cartId),xa(null==t?void 0:t.cartStatus),Bn(oe(Da,"marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},t),{cartVersion:e.cartVersion})).then(Pa)},e.isSupported=r}(Ha||(Ha={}))})(),r})()));
//# sourceMappingURL=MicrosoftTeams.min.js.map