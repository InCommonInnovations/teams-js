import{sendMessageToParent as e}from"../internal/communication.js";import{registerHandler as o}from"../internal/handlers.js";import{ensureInitialized as r}from"../internal/internalAPIs.js";import{getApiVersionTag as l}from"../internal/telemetry.js";import{FrameContexts as t}from"../public/constants.js";import{ErrorCode as n}from"../public/interfaces.js";import{runtime as i}from"../public/runtime.js";const d="v1";var a;!function(a){var s,u,c,g;function f(e,o){return{errorCode:e,message:o}}(s=a.CloudStorageProvider||(a.CloudStorageProvider={})).Dropbox="DROPBOX",s.Box="BOX",s.Sharefile="SHAREFILE",s.GoogleDrive="GOOGLEDRIVE",s.Egnyte="EGNYTE",s.SharePoint="SharePoint",(u=a.CloudStorageProviderType||(a.CloudStorageProviderType={}))[u.Sharepoint=0]="Sharepoint",u[u.WopiIntegration=1]="WopiIntegration",u[u.Google=2]="Google",u[u.OneDrive=3]="OneDrive",u[u.Recent=4]="Recent",u[u.Aggregate=5]="Aggregate",u[u.FileSystem=6]="FileSystem",u[u.Search=7]="Search",u[u.AllFiles=8]="AllFiles",u[u.SharedWithMe=9]="SharedWithMe",(a.SpecialDocumentLibraryType||(a.SpecialDocumentLibraryType={})).ClassMaterials="classMaterials",(a.DocumentLibraryAccessType||(a.DocumentLibraryAccessType={})).Readonly="readonly",(c=a.FileDownloadStatus||(a.FileDownloadStatus={})).Downloaded="Downloaded",c.Downloading="Downloading",c.Failed="Failed",(g=a.CloudStorageProviderFileAction||(a.CloudStorageProviderFileAction={})).Download="DOWNLOAD",g.Upload="UPLOAD",g.Delete="DELETE",a.getCloudStorageFolders=function(o,n){if(r(i,t.content),!o||0===o.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");e(l(d,"files.getCloudStorageFolders"),"files.getCloudStorageFolders",[o],n)},a.addCloudStorageFolder=function(o,n){if(r(i,t.content),!o||0===o.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!n)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");e(l(d,"files.addCloudStorageFolder"),"files.addCloudStorageFolder",[o],n)},a.deleteCloudStorageFolder=function(o,n,a){if(r(i,t.content),!o)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!a)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");e(l(d,"files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[o,n],a)},a.getCloudStorageFolderContents=function(o,n,a){if(r(i,t.content),!o||!n)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!a)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in o&&!o.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");e(l(d,"files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[o,n],a)},a.openCloudStorageFile=function(o,n,a){if(r(i,t.content),!o||!n)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(o.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");e(l(d,"files.openCloudStorageFile"),"files.openCloudStorageFile",[o,n,a])},a.getExternalProviders=function(o=!1,n){if(r(i,t.content),!n)throw new Error("[files.getExternalProviders] Callback cannot be null");e(l(d,"files.getExternalProviders"),"files.getExternalProviders",[o],n)},a.copyMoveFiles=function(o,n,a,s,u=!1,c){if(r(i,t.content),!o||0===o.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!a)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!s)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!c)throw new Error("[files.copyMoveFiles] callback cannot be null");e(l(d,"files.copyMoveFiles"),"files.copyMoveFiles",[o,n,a,s,u],c)},a.getFileDownloads=function(o){if(r(i,t.content),!o)throw new Error("[files.getFileDownloads] Callback cannot be null");e(l(d,"files.getFileDownloads"),"files.getFileDownloads",[],o)},a.openDownloadFolder=function(o=void 0,n){if(r(i,t.content),!n)throw new Error("[files.openDownloadFolder] Callback cannot be null");e(l(d,"files.openDownloadFolder"),"files.openDownloadFolder",[o],n)},a.addCloudStorageProvider=function(o){if(r(i,t.content),!o)throw f(n.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");e(l(d,"files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],o)},a.removeCloudStorageProvider=function(o,a){if(r(i,t.content),!a)throw f(n.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!o||!o.content)throw f(n.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");e(l(d,"files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[o],a)},a.addCloudStorageProviderFile=function(o,a){if(r(i,t.content),!a)throw f(n.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!o||!o.content)throw f(n.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");e(l(d,"files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[o],a)},a.renameCloudStorageProviderFile=function(o,a){if(r(i,t.content),!a)throw f(n.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!o||!o.content)throw f(n.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");e(l(d,"files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[o],a)},a.deleteCloudStorageProviderFile=function(o,a){if(r(i,t.content),!a)throw f(n.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(o&&o.content&&o.content.itemList&&o.content.itemList.length>0))throw f(n.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");e(l(d,"files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[o],a)},a.downloadCloudStorageProviderFile=function(o,a){if(r(i,t.content),!a)throw f(n.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(o&&o.content&&o.content.itemList&&o.content.itemList.length>0))throw f(n.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");e(l(d,"files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[o],a)},a.uploadCloudStorageProviderFile=function(o,a){if(r(i,t.content),!a)throw f(n.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(o&&o.content&&o.content.itemList&&o.content.itemList.length>0))throw f(n.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!o.content.destinationFolder)throw f(n.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");e(l(d,"files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[o],a)},a.registerCloudStorageProviderListChangeHandler=function(e){if(r(i),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");o(l(d,"files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)},a.registerCloudStorageProviderContentChangeHandler=function(e){if(r(i),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");o(l(d,"files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}}(a||(a={}));export{a as files};
