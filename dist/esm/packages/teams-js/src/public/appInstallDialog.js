import{sendAndHandleStatusAndReason as t,sendMessageToParent as n}from"../internal/communication.js";import{createTeamsDeepLinkForAppInstallDialog as e}from"../internal/deepLinkUtilities.js";import{ensureInitialized as o}from"../internal/internalAPIs.js";import{getApiVersionTag as i}from"../internal/telemetry.js";import{FrameContexts as r}from"./constants.js";import{runtime as p}from"./runtime.js";var a;!function(a){function s(){return!(!o(p)||!p.supports.appInstallDialog)}a.openAppInstallDialog=function(a){return new Promise((l=>{if(o(p,r.content,r.sidePanel,r.settings,r.task,r.stage,r.meetingStage),!s())throw new Error("Not supported");const m=i("v1","appInstallDialog.openAppInstallDialog");p.isLegacyTeams?l(t(m,"executeDeepLink",e(a.appId))):(n(m,"appInstallDialog.openAppInstallDialog",[a]),l())}))},a.isSupported=s}(a||(a={}));export{a as appInstallDialog};
