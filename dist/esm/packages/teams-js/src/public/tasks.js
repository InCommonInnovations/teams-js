import{__rest as t}from"../../../../node_modules/tslib/tslib.es6.js";import{sendMessageToParent as i}from"../internal/communication.js";import{ensureInitialized as o}from"../internal/internalAPIs.js";import{getApiVersionTag as r}from"../internal/telemetry.js";import{ChildAppWindow as e}from"./appWindow.js";import{FrameContexts as n,TaskModuleDimension as l}from"./constants.js";import{botUrlOpenHelper as a,urlOpenHelper as s,updateResizeHelper as d,urlSubmitHelper as u}from"./dialog.js";import{runtime as h}from"./runtime.js";const m="v1";var c;!function(c){function f(t){return t.height=t.height?t.height:l.Small,t.width=t.width?t.width:l.Small,t}c.startTask=function(t,d){const u=r(m,"tasks.startTask"),c=d?t=>{var i,o;return d(null!==(i=t.err)&&void 0!==i?i:"",null!==(o=t.result)&&void 0!==o?o:"")}:void 0;return void 0===t.card&&void 0===t.url||t.card?(o(h,n.content,n.sidePanel,n.meetingStage),i(u,"tasks.startTask",[t],d)):void 0!==t.completionBotId?a(u,function(t){if(void 0===t.url||void 0===t.completionBotId)throw new Error(`Both url ${t.url} and completionBotId ${t.completionBotId} are required for bot url dialog. At least one is undefined.`);const i={url:t.url,size:{height:t.height?t.height:l.Small,width:t.width?t.width:l.Small},title:t.title,fallbackUrl:t.fallbackUrl,completionBotId:t.completionBotId};return i}(t),c):s(u,function(t){if(void 0===t.url)throw new Error("url property of taskInfo object can't be undefined");const i={url:t.url,size:{height:t.height?t.height:l.Small,width:t.width?t.width:l.Small},title:t.title,fallbackUrl:t.fallbackUrl};return i}(t),c),new e},c.updateTask=function(i){i=f(i);const o=t(i,["width","height"]);if(Object.keys(o).length)throw new Error("resize requires a TaskInfo argument containing only width and height");d(r(m,"tasks.updateTask"),i)},c.submitTask=function(t,i){u(r(m,"tasks.submitTask"),t,i)},c.getDefaultSizeIfNotProvided=f}(c||(c={}));export{c as tasks};
