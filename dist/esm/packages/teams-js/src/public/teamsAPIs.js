import{GlobalVars as e}from"../internal/globalVars.js";import{registerOnLoadHandler as r,registerBeforeUnloadHandler as t}from"../internal/handlers.js";import{ensureInitialized as n}from"../internal/internalAPIs.js";import{getApiVersionTag as i}from"../internal/telemetry.js";import{isNullOrUndefined as o}from"../internal/typeCheckUtilities.js";import{ssrSafeWindow as a}from"../internal/utils.js";import{errorNotSupportedOnPlatform as l}from"./constants.js";import{runtime as s}from"./runtime.js";var p;!function(p){function m(){a().print()}function f(e,t,i){!o(t)&&n(s),!o(t)&&i&&i(),r(e,t)}function d(e,r,i){!o(r)&&n(s),!o(r)&&i&&i(),t(e,r)}function u(){return!(!n(s)||!s.supports.teamsCore)}p.enablePrintCapability=function(){if(!e.printCapabilityEnabled){if(n(s),!u())throw l;e.printCapabilityEnabled=!0,document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(m(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}},p.print=m,p.registerOnLoadHandler=function(e){f(i("v2","teamsAPIs_registerOnLoadHandler"),e,(()=>{if(!o(e)&&!u())throw l}))},p.registerOnLoadHandlerHelper=f,p.registerBeforeUnloadHandler=function(e){d(i("v2","teamsAPIs_registerBeforeUnloadHandler"),e,(()=>{if(!o(e)&&!u())throw l}))},p.registerBeforeUnloadHandlerHelper=d,p.isSupported=u}(p||(p={}));export{p as teamsCore};
